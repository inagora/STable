window.STable=function(t){var e={};function s(i){if(e[i])return e[i].exports;var l=e[i]={i:i,l:!1,exports:{}};return t[i].call(l.exports,l,l.exports,s),l.l=!0,l.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)s.d(i,l,function(e){return t[e]}.bind(null,l));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s(s.s=39)}([function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e,s){},function(t,e){t.exports={lang:"en",confirm:"confirm",cancel:"cancel",add:"add",edit:"edit",delete:"delete",search:"search",reset:"reset",tips:"tips",page:"page",compute:"compute",setting:"setting",operation:"operation",toolbar:{exportBtnText:"export current page",exportAllBtnText:"export all pages",confirmFileName:"please confirm the file's name",addSuccessMsg:"Added successfully"},deleteMsg:{confirmTip:"Are you sure to delete this record?",success:"successfully deleted",fail:"failed to delete"},editMsg:{confirmBtn:"confirm change",success:"Successfully modified"},requiredMsg:"must fill in ",chooseMsg:"please choose ",inputMsg:"please fill in ",numberMsg:"please input a number",upload:"upload",uploadProgress:"upload",uploadDone:"completed",uploadFail:"failed",uploadingMsg:"uploading, please wait a moment...",nextPage:"Next Page",previousPage:"Previous Page",noMoreBehind:"There is no more behind",noMoreFront:"There is no more in front",total:"total",sum:"sum",average:"average",downloadMsg:{start:"start downloading",update:"downloaded: ${loadedCount}pages，total: ${totalCount}pages",waterfallUpdate:"downloaded ${loadedCount} pages，please continue to wait...",loading:"downloading, please wait a moment..."},pageErrorMsg:"There is an error on page ${pageNo}",columnSetting:"column setting",columnName:"column name",lock:"lock",visible:"visible",saveColumnSetting:"save column's setting",clearColumnSettingTips:"Are you sure to clear the column settings and revert to the default state?",clearColumnSetting:"clear column setting",columnStorageError:"there is an error in storing column settings",emptyMsg:"the table is empty~~",pageSizeUnit:"rows/page"}},function(t,e,s){"use strict";var i=s(0);s.n(i).a},function(t,e,s){"use strict";var i=s(1);s.n(i).a},function(t,e,s){"use strict";var i=s(2);s.n(i).a},function(t,e,s){"use strict";var i=s(3);s.n(i).a},function(t,e,s){},function(t,e,s){"use strict";var i=s(4);s.n(i).a},function(t,e,s){"use strict";var i=s(5);s.n(i).a},function(t,e,s){"use strict";var i=s(6);s.n(i).a},function(t,e,s){"use strict";var i=s(7);s.n(i).a},function(t,e,s){"use strict";var i=s(8);s.n(i).a},function(t,e,s){"use strict";var i=s(9);s.n(i).a},function(t,e,s){"use strict";var i=s(10);s.n(i).a},function(t,e,s){"use strict";var i=s(11);s.n(i).a},function(t,e,s){"use strict";var i=s(12);s.n(i).a},function(t,e,s){"use strict";var i=s(13);s.n(i).a},function(t,e,s){"use strict";var i=s(14);s.n(i).a},function(t,e,s){},function(t,e,s){"use strict";var i=s(15);s.n(i).a},function(t,e,s){"use strict";var i=s(16);s.n(i).a},function(t,e,s){"use strict";var i=s(17);s.n(i).a},function(t,e,s){"use strict";s.r(e),s.d(e,"createDialog",(function(){return R})),s.d(e,"qtip",(function(){return M})),s.d(e,"Progressbar",(function(){return zt})),s.d(e,"version",(function(){return oe})),s.d(e,"init",(function(){return re}));var i=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"st-stable",class:["expand"==this.config.layoutMode?"st-expand-stable":"st-fixed-stable"]},[e("div",{staticClass:"st-stable-doc"},[this._l(this.comOrder,(function(t){return[e(t.com,{key:t.name,ref:t.name,refInFor:!0,tag:"component"})]}))],2)])};i._withStripped=!0;var l=function(){var t=this.$createElement,e=this._self._c||t;return this.title?e("div",{staticClass:"st-title"},[e("div",{staticClass:"st-title-text",domProps:{textContent:this._s(this.title)}})]):this._e()};l._withStripped=!0;var o={inject:["title"]};s(19);function r(t,e,s,i,l,o,r,a){var n,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=s,d._compiled=!0),i&&(d.functional=!0),o&&(d._scopeId="data-v-"+o),r?(n=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),l&&l.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=n):l&&(n=a?function(){l.call(this,this.$root.$options.shadowRoot)}:l),n)if(d.functional){d._injectStyles=n;var c=d.render;d.render=function(t,e){return n.call(e),c(t,e)}}else{var h=d.beforeCreate;d.beforeCreate=h?[].concat(h,n):[n]}return{exports:t,options:d}}var a=r(o,l,[],!1,null,null,null);a.options.__file="src/Title.vue";var n=a.exports,d=function(){var t=this.$createElement,e=this._self._c||t;return this.tip?e("div",{staticClass:"st-tip",domProps:{innerHTML:this._s(this.tip)}}):this._e()};d._withStripped=!0;var c={inject:["tip"]},h=(s(20),r(c,d,[],!1,null,null,null));h.options.__file="src/Tip.vue";var u=h.exports,p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.btns.length>0?s("div",{staticClass:"st-toolbar"},[t._l(t.btns,(function(e,i){return["|"==e?s("div",{key:i,staticClass:"st-toolbar-separator"},[t._v("\n\t\t\t \n\t\t")]):" "==e?s("div",{key:i,staticClass:"st-toolbar-space"}):s("x-button",{key:i,ref:"btn",refInFor:!0,attrs:{conf:e},on:{click:function(s){return t.triggerClick(e,s)}}})]}))],2):t._e()};p._withStripped=!0;var f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",t._b({directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],class:["st-btn",t.themeCls,t.sizeCls,t.cls],style:t.style,attrs:{type:t.nativeType,disabled:t.disabled},on:{click:function(e){return t.$emit("click",e)}}},"button",t.otherConf,!1),[t.icon?s("i",{class:["st-btn-icon",t.icon]}):t._e(),t._v(" "),t.text?s("span",{staticClass:"st-btn-text"},[t._v(t._s(t.btnText))]):t._e()])};f._withStripped=!0;const m=/^[\u4e00-\u9fa5]{2}$/;var g={props:{conf:{type:Object,default:()=>({})}},data(){let t={},e={};for(let s in this.conf)["text","type","nativeType","icon","size","disabled","cls","style","click","visible"].includes(s)?e[s]=this.conf[s]:t[s]=this.conf[s];return Object.assign({text:"",type:"default",nativeType:"button",icon:"",size:"medium",disabled:!1,cls:"",visible:!0,style:null,otherConf:t},e)},computed:{btnText(){let t=String(this.text||"").trim();return m.test(t)&&!this.icon&&(t=t.split("").join(" ")),t},themeCls(){let t={default:"st-btn-default",primary:"st-btn-primary",success:"st-btn-success",danger:"st-btn-danger",warning:"st-btn-warning",info:"st-btn-info",link:"st-btn-link"}[this.type];return t||(t="st-btn-default"),t},sizeCls(){let t="md";return"large"==this.size?t="lg":"small"==this.size&&(t="sm"),{lg:"st-btn-lg",md:"st-btn-md",sm:"st-btn-sm"}[t]}},watch:{"conf.disabled"(t){this.disabled=t},"conf.visible"(t){this.visible=t},"conf.text"(t){this.text=t},"conf.cls"(t){this.cls=t}}},b=(s(21),r(g,f,[],!1,null,null,null));b.options.__file="src/com/Button.vue";var v=b.exports;let x={};function y(t){if(x[t])return x[t];{let e=new Promise(e=>{let s=document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");i.src=t,i.onload=i.onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(i.onload=i.onreadystatechange=null,s.removeChild(i),e())},s.insertBefore(i,s.firstChild)});return x[t]=e,e}}let _={};function w(t){if(_[t])return _[t];{let e=new Promise(e=>{let s=document.createElement("link");s.rel="stylesheet",s.href=t,document.head.insertBefore(s,document.head.childNodes[document.head.childNodes.length-1].nextSibling),e()});return _[t]=e,e}}window.navigator.vendor.toLowerCase().includes("apple computer");let C=window.navigator.userAgent.toLowerCase().includes("firefox"),k={log(...t){window.console&&window.console.log.apply(window.console,t)},warn(...t){window.console&&window.console.warn.apply(window.console,t)},error(...t){window.console&&window.console.error.apply(window.console,t)}},I={},S=I.toString;function A(t){return null==t?String(t):I[S.call(t)]||"object"}function $(t){return function(t){return"object"==A(t)}(t)&&Object.getPrototypeOf(t)==Object.prototype}"Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(t=>{I["[object "+t+"]"]=t.toLowerCase()});var P=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"st-dialog"},[t.modal?s("div",{staticClass:"st-dialog-mask"}):t._e(),t._v(" "),s("div",{staticClass:"st-dialog-doc",style:{width:t.width,height:t.height,left:t.left,top:t.top}},[s("div",{staticClass:"st-dialog-head"},[s("div",{staticClass:"st-dialog-title",class:{"st-dialog-draggable":t.draggable},domProps:{textContent:t._s(t.title)},on:{mousedown:t.prepareDrag}}),t._v(" "),t.closable?s("div",{staticClass:"st-dialog-close st-icon st-icon-close",on:{click:function(e){return t.$emit("close")}}}):t._e()]),t._v(" "),s("div",{staticClass:"st-dialog-body",class:[t.bodyCls],style:t.bodyStyle},[t._t("default")],2),t._v(" "),t.buttons&&t.buttons.length>0?s("div",{staticClass:"st-dialog-foot"},t._l(t.buttons,(function(e,i){return s("x-button",{key:i,attrs:{conf:e},on:{click:function(e){return t.btnClick(i,e)}}})})),1):t._e(),t._v(" "),t.resizable?s("div",{on:{mousedown:t.prepareResize}},[s("div",{staticClass:"st-dialog-rz st-dialog-n"}),t._v(" "),s("div",{staticClass:"st-dialog-rz st-dialog-e"}),t._v(" "),s("div",{staticClass:"st-dialog-rz st-dialog-s"}),t._v(" "),s("div",{staticClass:"st-dialog-rz st-dialog-w"}),t._v(" "),s("div",{staticClass:"st-dialog-rz st-dialog-nw"}),t._v(" "),s("div",{staticClass:"st-dialog-rz st-dialog-ne"}),t._v(" "),s("div",{staticClass:"st-dialog-rz st-dialog-se"}),t._v(" "),s("div",{staticClass:"st-dialog-rz st-dialog-sw"})]):t._e()]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.proxyVisible,expression:"proxyVisible"}],staticClass:"st-dialog-proxy"})])};P._withStripped=!0;let E=document.documentElement;var L={inject:["dialogConfig"],components:{XButton:v},data(){let t=Object.assign({title:"",width:640,height:480,left:0,top:0,autoShow:!0,closable:!0,modal:!0,closeAction:"destroy",bodyCls:"",bodyStyle:{},listeners:{},buttons:[],resizable:!0,draggable:!0,proxyVisible:!1},this.dialogConfig),e=typeof t.width,s=typeof t.height;return"string"==e&&t.width.endsWith("%")?t.width=Math.ceil(E.clientWidth*parseFloat(t.width)/100)+"px":t.width+="px","string"==s&&t.height.endsWith("%")?t.height=Math.ceil(E.clientHeight*parseFloat(t.height)/100)+"px":t.height+="px",void 0!==t.autoOpen&&(t.autoShow=t.autoOpen),t.visible=t.autoShow,t},watch:{visible(t){t&&this.show()}},mounted(){this.dialogConfig.contentEl&&this.$el.querySelector(".st-dialog-body").appendChild(this.dialogConfig.contentEl),this.visible&&this.show()},methods:{show(){this.$nextTick(()=>{let t=this.$el.querySelector(".st-dialog-doc").getBoundingClientRect();this.left=Math.ceil((E.clientWidth-t.width)/2)+"px",this.top=Math.ceil((E.clientHeight-t.height)/2)+"px"})},btnClick(t,e){this.buttons[t].click&&this.buttons[t].click.call(this.$root,this.buttons[t],e)},prepareDrag(t){this.draggable&&(t.preventDefault(),this.clearDrag(),this.canDrag=!0,this.dragHandle=this.drag.bind(this),this.stopDragHandle=this.stopDrag.bind(this),this.dragPos={startX:t.clientX,startY:t.clientY,rect:this.$el.querySelector(".st-dialog-doc").getBoundingClientRect()},E.addEventListener("mousemove",this.dragHandle,!1),E.addEventListener("mouseup",this.stopDragHandle,!1))},drag(t){if(!this.canDrag)return;t.preventDefault();let e=this.dragPos.rect;this.proxy||(this.proxy=this.$el.querySelector(".st-dialog-proxy"),this.proxyVisible=!0,this.proxy.style.cssText="top: ".concat(e.top,"px;left:").concat(e.left,"px;width:").concat(e.width,"px;height:").concat(e.height,"px")),this.proxy.style.left=e.left+(t.clientX-this.dragPos.startX)+"px",this.proxy.style.top=e.top+(t.clientY-this.dragPos.startY)+"px"},clearDrag(){this.canDrag=!1,this.dragHandle&&(E.removeEventListener("mousemove",this.dragHandle,!1),E.removeEventListener("mouseup",this.stopDragHandle,!1),this.dragHandle=null,this.stopDragHandle=null,this.proxy=null,this.proxyVisible=!1)},stopDrag(t){this.clearDrag(),this.left=t.clientX-this.dragPos.startX+this.dragPos.rect.left+"px",this.top=t.clientY-this.dragPos.startY+this.dragPos.rect.top+"px"},prepareResize(t){if(!this.resizable)return;let e="",s={n:"st-dialog-n",e:"st-dialog-e",s:"st-dialog-s",w:"st-dialog-w",nw:"st-dialog-nw",ne:"st-dialog-ne",se:"st-dialog-se",sw:"st-dialog-sw"};for(let i of["n","e","s","w","nw","ne","se","sw"])if(t.target.classList.contains(s[i])){e=i;break}e&&(t.preventDefault(),this.clearResize(),this.canResize=!0,this.resizeHandle=this.resize.bind(this),this.stopResizeHandle=this.stopResize.bind(this),this.resizePos={type:e,startX:t.clientX,startY:t.clientY,rect:this.$el.querySelector(".st-dialog-doc").getBoundingClientRect()},E.addEventListener("mousemove",this.resizeHandle,!1),E.addEventListener("mouseup",this.stopResizeHandle,!1))},resize(t){if(!this.canResize)return;t.preventDefault();let e,s,i,l,{rect:o,startX:r,startY:a}=this.resizePos;this.proxy||(this.proxy=this.$el.querySelector(".st-dialog-proxy"),this.proxyVisible=!0,this.proxy.style.cssText="top: ".concat(o.top,"px;left:").concat(o.left,"px;width:").concat(o.width,"px;height:").concat(o.height,"px"));switch(this.resizePos.type){case"nw":e=t.clientX-r+o.left,s=t.clientY-a+o.top,i=o.width-(t.clientX-r),l=o.height-(t.clientY-a),i<50&&(i=50,e=o.left+o.width-50),l<50&&(l=50,s=o.top+o.height-50);break;case"ne":e=o.left,s=t.clientY-a+o.top,i=t.clientX-r+o.width,l=o.height-(t.clientY-a),i<50&&(i=50),l<50&&(l=50,s=o.top+o.height-50);break;case"se":e=o.left,s=o.top,i=t.clientX-r+o.width,l=t.clientY-a+o.height,i<50&&(i=50),l<50&&(l=50);break;case"sw":e=t.clientX-r+o.left,s=o.top,i=o.width-(t.clientX-r),l=t.clientY-a+o.height,i<50&&(i=50,e=o.left+o.width-50),l<50&&(l=50);break;case"n":e=o.left,s=t.clientY-a+o.top,i=o.width,l=o.height-(t.clientY-a),l<50&&(l=50,s=o.top+o.height-50);break;case"e":e=o.left,s=o.top,i=t.clientX-r+o.width,l=o.height,i<50&&(i=50);break;case"s":e=o.left,s=o.top,i=o.width,l=t.clientY-a+o.height,l<50&&(l=50);break;case"w":e=t.clientX-r+o.left,s=o.top,i=o.width-(t.clientX-r),l=o.height,i<50&&(i=50,e=o.left+o.width-50)}this.proxy.style.cssText="top: ".concat(s,"px;left:").concat(e,"px;width:").concat(i,"px;height:").concat(l,"px")},clearResize(){this.canResize=!1,this.resizeHandle&&(E.removeEventListener("mousemove",this.resizeHandle,!1),E.removeEventListener("mouseup",this.stopResizeHandle,!1),this.resizeHandle=null,this.stopResizeHandle=null,this.proxy=null,this.proxyVisible=!1)},stopResize(){if(this.proxy){let t=this.proxy.getBoundingClientRect();this.left=t.left+"px",this.top=t.top+"px",this.width=t.width+"px",this.height=t.height+"px"}this.clearResize()}}},T=(s(22),r(L,P,[],!1,null,null,null));T.options.__file="src/com/Dialog.vue";var D=T.exports;function R(t){let e=document.createElement("div");document.body.appendChild(e);let s={};["title","width","height","bodyCls","bodyStyle","autoShow","autoOpen","closable","closeAction","listeners","modal","buttons","contentEl","html"].forEach(e=>{Object.prototype.hasOwnProperty.call(t,e)&&(s[e]=t[e],delete t[e])});let i={_trigger(t){let e=s.listeners||{};if(e[t])return e[t].call(this)},show(){let t=this._trigger("beforeshow");return!1!==t&&(this.$refs.dialog.visible=!0,this._trigger("show")),t},hide(){let t=this._trigger("beforehide");return!1!==t&&(this.$refs.dialog.visible=!1,this._trigger("hide")),t},destroy(){let t=this._trigger("beforedestroy");return!1!==t&&(this.$destroy(),this.$el.remove(),this._trigger("destroy")),t},open(){this.show()},close(){let t=this._trigger("beforeclose");return!1!==t&&(t=this.hide()),!1!==t&&"hide"!=this.$refs.dialog.closeAction&&(t=this.destroy()),!1!==t&&this._trigger("close"),t}};for(let e in i){if(void 0===t.methods&&(t.methods={}),t.methods[e])return alert("dialog的methods里请不要声明 ".concat(e," 方法")),null;t.methods[e]=i[e]}return t.mounted||(t.mounted=function(){this._trigger("ready")}),new Vue(Object.assign(t,{provide:{dialogConfig:s},template:'<x-dialog @close="close" ref="dialog">'.concat(s.html||"","</x-dialog>"),components:{XDialog:D}})).$mount(e)}s(23);let q,j=[];function z(t,e,s,i){q||(q=document.createElement("div"),q.className="st-qtip-box",document.body.appendChild(q)),"function"==typeof s&&(i=s,s=3),void 0===s&&(s=3);let l=document.createElement("div");return l.className="st-qtip ".concat({success:"st-qtip-success",error:"st-qtip-error",info:"st-qtip-info",warning:"st-qtip-warning",warn:"st-qtip-warn",loading:"st-qtip-loading"}[t]),l.innerHTML='\n\t\t<div class="st-qtip-body">\n\t\t\t<i class="st-qtip-icon st-icon '.concat({success:"st-icon-check-circle-fill",error:"st-icon-close-circle-fill",info:"st-icon-info-circle-fill",warning:"st-icon-warning-circle-fill",warn:"st-icon-warning-circle-fill",loading:"st-icon-sync"}[t],'"></i>\n\t\t\t<span>').concat(e||"","</span>\n\t\t</div>\n\t"),q.appendChild(l),new Promise(t=>{setTimeout((function(){if(l.classList.add("st-qtip-visible"),s){setTimeout((function(){l.classList.remove("st-qtip-visible")}),1e3*s),l.addEventListener("transitionend",(function e(){l.classList.contains("st-qtip-visible")||(l.removeEventListener("transitionend",e,!1),l.remove(),i&&"function"==typeof i&&i(),t())}),!1)}else j.push({el:l,resolve:t,onclose:i})}),0)})}var M={show:z,destroy(){j.forEach(t=>{let e=t.el,s=t.resolve,i=t.onclose;e.classList.remove("st-qtip-visible"),e.addEventListener("transitionend",(function t(){e.classList.contains("st-qtip-visible")||(e.removeEventListener("transitionend",t,!1),e.remove(),i&&"function"==typeof i&&i(),s())}),!1)}),j=[]},info:(t,e,s)=>z("info",t,e,s),success:(t,e,s)=>z("success",t,e,s),error:(t,e,s)=>z("error",t,e,s),warn:(t,e,s)=>z("warn",t,e,s),warning:(t,e,s)=>z("warn",t,e,s),loading:(t,e,s)=>z("loading",t,e,s)},O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{staticClass:"st-form",class:[t.inline?"st-form-inline":"st-form-v"],on:{submit:function(e){return e.preventDefault(),t.submit(e)},reset:function(e){return e.preventDefault(),t.reset(e)}}},[t._l(t.fields,(function(e,i){return s("div",{key:i,staticClass:"st-form-field"},[s("label",{directives:[{name:"show",rawName:"v-show",value:t.labelVisible,expression:"labelVisible"}],staticClass:"st-form-label",style:t.labelStyle},[e.required?s("span",{staticClass:"st-form-required"},[t._v("*")]):t._e(),t._v(" "),s("span",{domProps:{textContent:t._s(e.label)}})]),t._v(" "),s("div",{staticClass:"st-form-com"},[s("div",{staticClass:"st-form-input-box",class:[{"st-form-input-box-focus":e._st_focus,"st-form-input-box-error":e.errmsg},"st-form-input-box-"+e.type],style:[e.style],on:{mouseenter:function(s){return t.showErrmsg(e.errmsg,s)},mouseleave:t.hideErrmsg}},["file"==e.type?s("x-file",{key:i,ref:"field_"+i,refInFor:!0,attrs:{field:e},model:{value:t.formData[e.name],callback:function(s){t.$set(t.formData,e.name,s)},expression:"formData[field.name]"}}):s(t.coms[e.type],{key:i,ref:"field_"+i,refInFor:!0,tag:"component",attrs:{field:e},on:{"update:errmsg":function(s){return t.updateErrmsg(e,s)},fieldfocus:function(t){e._st_focus=!0},fieldblur:function(t){e._st_focus=!1}},model:{value:t.formData[e.name],callback:function(s){t.$set(t.formData,e.name,s)},expression:"formData[field.name]"}})],1),t._v(" "),t.inline?t._e():s("div",{staticClass:"st-form-msg",domProps:{textContent:t._s(e.errmsg)}})])])})),t._v(" "),t._t("default")],2)};O._withStripped=!0;var V=function(){var t=this,e=t.$createElement,s=t._self._c||e;return"checkbox"===(t.field.nativeType||"text")?s("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"st-form-input",attrs:{name:t.field.name,placeholder:t.field.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(t.val)?t._i(t.val,null)>-1:t.val},on:{focus:function(e){return t.$emit("fieldfocus")},blur:function(e){t.$emit("fieldblur"),t.validate()},input:function(e){return t.validate(!0)},change:function(e){var s=t.val,i=e.target,l=!!i.checked;if(Array.isArray(s)){var o=t._i(s,null);i.checked?o<0&&(t.val=s.concat([null])):o>-1&&(t.val=s.slice(0,o).concat(s.slice(o+1)))}else t.val=l}}}):"radio"===(t.field.nativeType||"text")?s("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"st-form-input",attrs:{name:t.field.name,placeholder:t.field.placeholder,type:"radio"},domProps:{checked:t._q(t.val,null)},on:{focus:function(e){return t.$emit("fieldfocus")},blur:function(e){t.$emit("fieldblur"),t.validate()},input:function(e){return t.validate(!0)},change:function(e){t.val=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"st-form-input",attrs:{name:t.field.name,placeholder:t.field.placeholder,type:t.field.nativeType||"text"},domProps:{value:t.val},on:{focus:function(e){return t.$emit("fieldfocus")},blur:function(e){t.$emit("fieldblur"),t.validate()},input:[function(e){e.target.composing||(t.val=e.target.value)},function(e){return t.validate(!0)}]}})};V._withStripped=!0;var N={methods:{formatRule(){let t=(this.field.rules||[]).slice(0),e=this.field.type;if("undefined"!=A(this.field.min)&&!t.some(t=>"undefined"!=A(t.min))){let s={min:this.field.min,trigger:"blur"};s.message="number"==e?"数字不能小于"+this.field.min:"multiple"==e?"最少选择"+this.field.min+"项":"输入不能少于"+this.field.min+"个字符",t.push(s)}if("undefined"!=A(this.field.max)&&!t.some(t=>"undefined"!=A(t.max))){let s={max:this.field.max,trigger:"blur"};s.message="number"==e?"数字不能大于"+this.field.max:"multiple"==e?"最多选择"+this.field.max+"项":"输入不能多于"+this.field.max+"个字符",t.push(s)}if(this.field.required&&!t.some(t=>"undefined"!=A(t.required))){let s={required:!0,trigger:"blur"};"date"==e?s.message="请选择日期":"datetime"==e?s.message="请选择时间":["select","combobox","cascader","multiple"].includes(e)?s.message="请选择"+this.field.label:s.message="请填写"+this.field.label,t.push(s)}if(this.field.pattern){let e=this.field.pattern;"string"==A(e)&&(e=new RegExp("^"+e+"$"));let s={pattern:e,message:"请与所要求的格式保持一致",trigger:"blur"};t.push(s)}if("number"==e&&!t.some(t=>"undefined"!=A(t.pattern))){let e={pattern:/^-?(\d+\.?|\d*\.\d+)+$/,message:"请填入数字",trigger:"blur"};t.push(e)}this.rules=t},validate(t){let e=this.field.type,s="";for(let i of this.rules)if(!t||"change"==i.trigger){if(i.validator&&!i.validator(i,this.value)){s=i.message;break}if("undefined"!=A(i.min))if("number"==e){if(parseFloat(this.value)<i.min){s=i.message;break}}else if("multiple"==e){if(this.value.length<i.min){s=i.message;break}}else if(this.value.length<i.min){s=i.message;break}if("undefined"!=A(i.max))if("number"==e){if(parseFloat(this.value)>i.max){s=i.message;break}}else if("multiple"==e){if(this.value.length>i.max){s=i.message;break}}else if(this.value.length>i.max){s=i.message;break}if(this.field.required)if(["date","datetime","text","select","combobox"].includes(e)){if(""===this.value){s=i.message;break}}else if(["cascader","multiple"].includes(e)&&this.value.length<=0){s=i.message;break}if("string"==A(this.value)&&i.pattern&&!i.pattern.test(this.value)){s=i.message;break}}return this.$emit("update:errmsg",s),!s}}},F=r({mixins:[N],props:{field:{type:Object,default:()=>({})},value:{type:[String,Number],default:""}},data(){return{val:this.value}},watch:{val(t){this.$emit("input",t)}},mounted(){let t=this.field.type;"datetime"!=t&&"date"!=t||Promise.all([w("https://cdn.jsdelivr.net/npm/flatpickr@4.6.3/dist/flatpickr.min.css"),y("https://cdn.jsdelivr.net/npm/flatpickr@4.6.3/dist/flatpickr.min.js")]).then(()=>{let e={dateFormat:"datetime"==t?"Y-m-d H:i:S":"Y-m-d",wrap:!1,defaultDate:new Date};"datetime"==t&&(e=Object.assign(e,{enableTime:!0,time_24hr:!0,enableSeconds:!0})),this.field.dateConfig&&("object"==A(this.field.dateConfig)?e=Object.assign(e,this.field.dateConfig):"function"==A(this.field.dateConfig)&&(e=Object.assign(e,this.field.dateConfig(this.field)))),window.flatpickr(this.$el,e)}),this.formatRule()}},V,[],!1,null,null,null);F.options.__file="src/form/Input.vue";var W=F.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"st-cbb",on:{click:function(t){t.stopPropagation()}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"st-form-input",attrs:{type:"text",name:t.field.name,autocomplete:"off",placeholder:t.placeholder,readonly:!t.field.filterable},domProps:{value:t.text},on:{focus:function(e){t.focus(),t.$emit("fieldfocus")},blur:function(e){return t.$emit("fieldblur")},input:[function(e){e.target.composing||(t.text=e.target.value)},t.doFilter],keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.hlNext(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.hlPre(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.enterSelect(e))}],mousedown:t.showDdm}}),t._v(" "),t.loading?t._e():s("div",{staticClass:"st-cbb-trigger st-icon st-icon-left",class:{"st-cbb-trigger-down":t.ddmVisible},on:{click:function(e){t.$el.querySelector("input").focus()}}}),t._v(" "),t.field.clearable&&["combobox","cascader"].includes(t.field.type)&&t.selIdxes.length>0?s("div",{staticClass:"st-cbb-clear st-icon st-icon-close",on:{click:function(e){t.selIdxes=[],t.$el.querySelector("input").focus()}}}):t._e(),t._v(" "),t.loading?s("span",{staticClass:"st-icon st-icon-sync st-cbb-load"}):t._e()])};H._withStripped=!0;var B=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.visible&&("cascader"==t.type||t.visibleCount>0),expression:"visible && (type=='cascader'||visibleCount>0)"}],staticClass:"st-ddm",class:{"st-ddm-cascader":"cascader"==t.type},style:{top:t.top+"px",left:t.left+"px"},on:{click:function(t){t.stopPropagation()}}},t._l(t.menuList,(function(e,i){return s("div",{key:i,staticClass:"st-ddm-fly",style:{width:t.width+"px"},on:{mouseleave:function(e){t.hlIndex=-1,t.hlLevel=0}}},[t._l(e,(function(e,l){return["cascader"==t.type||e.visible?s("div",{key:l,staticClass:"st-ddm-item",class:{"st-ddm-hl":l==t.hlIndex&&t.hlLevel==i,"st-ddm-sel":"cascader"==t.type?t.selIndexes[i]==l:t.selIndexes.includes(l)},on:{mouseenter:function(e){return t.hlItem(l,i)},mouseup:function(s){return t.select(e,i,l)}}},[s("span",{staticClass:"st-ddm-check"},[t._v("✓")]),t._v(" "),s("span",{staticClass:"st-ddm-text",attrs:{title:e.text},domProps:{textContent:t._s(e.text)}}),t._v(" "),"cascader"==t.type?s("span",{staticClass:"st-ddm-expand",class:{"st-ddm-expand-visible":e.options}},[t._v("›")]):t._e()]):t._e()]}))],2)})),0)};B._withStripped=!0;let X=[];var U={props:{options:{type:Array,default:()=>[]},selected:{type:Array,default:()=>[]},type:{type:String,default:"combobox"},pinyinSearchable:{type:Boolean,default:!1}},data(){return{visible:!1,hlIndex:-1,hlLevel:0,visibleCount:0,width:150,top:-1e4,left:0,selIndexes:this.selected.slice(0),menuList:[]}},watch:{options(){this.rebuildMenu()},visible(t){this.$emit("update:visible",t),t&&this.selIndexes.length>0&&this.$nextTick(()=>{let t=this.$el.querySelectorAll(".st-ddm-sel");if(!(!t.length<=0))for(let e of t)e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView()})},selected(t){this.selIndexes=t.slice(0),this.$nextTick(()=>{this.adjustPos()})}},mounted(){this.rebuildMenu(),X.push(this)},beforeDestroy(){X=X.filter(t=>t!=this)},methods:{rebuildMenu(){this.filter(this.lastFilterKey||""),this.menuList=[this.options];let t=this.options;for(let e of this.selIndexes){if(!t[e])break;if(t=t[e].options,!t)break;this.menuList.push(t)}},bindAlign(t){this.alignEl=t},show(){this.visible=!0,X.forEach(t=>{t!=this&&t.hide()}),this.$nextTick(()=>{this.adjustPos()})},adjustPos(){if(!this.alignEl)return;let t=this.$el.getBoundingClientRect(),e=this.alignEl.getBoundingClientRect(),s=document.documentElement;"cascader"!=this.type&&(this.width=e.width),e.bottom+t.height-s.scrollTop<s.clientHeight?this.top=e.bottom+5-s.scrollTop:this.top=e.top+s.scrollTop-t.height-5,e.left+t.width-s.scrollLeft<s.clientWidth?this.left=e.left-s.scrollLeft:this.left=s.clientWidth+s.scrollLeft-t.width},hide(){this.visible=!1},hlItem(t,e){this.hlIndex=t,this.hlLevel=e},hlNext(){if("cascader"==this.type)return;let t=!1;if("combobox"==this.type&&this.hlIndex<0&&this.selected.length>0)this.hlIndex=this.selected[0];else for(let e=this.hlIndex+1,s=this.options.length;e<s;e++)if(this.options[e].visible){this.hlIndex=e,t=!0;break}if(!t)for(let e=0;e<this.hlIndex;e++)if(this.options[e].visible){this.hlIndex=e,t=!0;break}this.hl()},hlPre(){if("cascader"==this.type)return;let t=!1;for(let e=this.hlIndex-1;e>=0;e--)if(this.options[e].visible){this.hlIndex=e,t=!0;break}if(!t)for(let e=this.options.length-1;e>this.hlIndex;e--)if(this.options[e].visible){this.hlIndex=e,t=!0;break}this.hl()},hl(){this.visible=!0,this.$nextTick(()=>{let t=this.$el.querySelectorAll(".st-ddm-hl");for(let e of t)e&&(e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView())})},filter(t){if("cascader"!=this.type){this.lastFilterKey=t,t=t.trim().toLowerCase();let e=0;t?this.options.forEach(s=>{let i=s.lowerText.includes(t);!i&&this.pinyinSearchable&&(i=s._s[0].includes(t)||s._s[1].includes(t)||s._s[2].includes(t)),s.visible=i,s.visible&&e++}):(this.options.forEach(t=>{t.visible=!0}),e=this.options.length),this.visibleCount=e}if(this.visible){let t=-1;if("cascader"!=this.type)for(let e=0,s=this.options.length;e<s;e++)if(this.options[e].visible){t=e;break}this.hlIndex=t,this.hl(),this.show()}},select(t,e,s){if(this.visible)if("cascader"!=this.type)this.$emit("select",this.hlIndex);else{let i=this.selIndexes.slice(0,e+1);i[e]=s,this.selIndexes=i,t.options?(this.menuList.splice(e+1),this.menuList.push(t.options),this.$nextTick(()=>{this.adjustPos()})):this.$emit("select",i)}}}},Y=(s(24),r(U,B,[],!1,null,"4b5acfda",null));Y.options.__file="src/form/Dropdown.vue";var K=Y.exports;var J={mixins:[N],props:{value:{type:[String,Number,Array],default:""},field:{type:Object,default:()=>({})}},inject:["ajax"],components:{XDropdown:K},data(){return{options:[],text:"",selIdxes:[],loading:!1,ddmVisible:!1,placeholder:this.field.placeholder}},mounted(){document.documentElement.addEventListener("click",()=>{"combobox"==this.field.type&&(this.selIdxes.length>0?this.text=this.options[this.selIdxes[0]].text:this.text=""),this.$nextTick(()=>{this.ddm&&this.ddm.hide()})},!1);let t=A(this.field.options);"string"==t?(this.loading=!0,this.ajax.request({url:this.field.options}).then(t=>{this.loading=!1,0==t.errno||0==t.code?this.formatList(t.data.options):M.error(t.errmsg||t.msg)})):"function"==t?(this.loading=!0,this.field.options(this.field).then(t=>{this.loading=!1,this.formatList(t)})):this.formatList(),this.formatRule()},watch:{selIdxes(t){let e=this.field.type,s=[],i="";if("combobox"==e)s="",this.options[t[0]]&&(s=this.options[t[0]].value,i=this.options[t[0]].text);else if("multiple"==e)s=t.map(t=>this.options[t].value);else if("cascader"==e){let e=this.options;i=[];for(let l of t){if(!e[l])break;i.push(e[l].text),s.push(e[l].value),e=e[l].options}i=i.join(" / ")}this.text=i,this.$emit("input",s),this.ddm&&(this.ddm.$parent.selIdxes=t)}},methods:{formatList(t){let e=this.field,s=t||e.options,i=[];"cascader"==e.type?Array.isArray(s)?function t(e,s){s.forEach(s=>{let i={};if(Array.isArray(s))i={value:s[0],text:s[1]},s[2]&&Array.isArray(s[2])&&(i.options=[],t(i.options,s[2]));else if(i=s,i.options||i.list){let e=[];t(e,i.options||i.list),i.options=e}e.push(i)})}(i,s):function t(e,s){Object.keys(s).map(i=>{let l={value:i};"object"==A(s[i])?(l.text=s[i].text,(s[i].options||s[i].list)&&(l.options=[],t(l.options,s[i].options||s[i].list))):l.text=s[i],e.push(l)})}(i,s):i=Array.isArray(s)?s.map(t=>"string"==A(t)?{text:t,value:t,visible:!0,lowerText:t.toLowerCase()}:(t.lowerText=t.text.toLowerCase(),t.visible=!0,t)):Object.keys(s).map(t=>({text:s[t],value:t,visible:!0,lowerText:s[t].toLowerCase()})),this.options=i,this.initSelect(),this.field.pinyinSearchable&&y("https://cdn.jsdelivr.net/gh/inagora/STable@v2.0.0-beta.46/dist/pinyin.min.js").then(()=>{let t=window.STable.Pinyin,e=function(t){return t.map(t=>t[0]).join("")};i.forEach(s=>{let i=s.lowerText;s._s=[e(t(i,{style:t.STYLE_FIRST_LETTER})),e(t(i,{style:t.STYLE_INITIALS})),e(t(i,{style:t.STYLE_NORMAL}))]})})},hlNext(){this.ddm&&this.ddm.hlNext()},hlPre(){this.ddm&&this.ddm.hlPre()},showDdm(){let t=this;if(!this.ddm){let e=document.createElement("div");document.body.appendChild(e);let s=new Vue({el:e,components:{XDropdown:K},data:{options:this.options,selIdxes:this.selIdxes,field:this.field,ddmVisible:!1,visible:!1},methods:{changeVal(e){if("multiple"==this.field.type){let s=this.selIdxes.slice(0);s.includes(e)?s=s.filter(t=>t!=e):s.push(e),t.selIdxes=s}else"cascader"==this.field.type?t.selIdxes=e.slice(0):t.selIdxes=[e],this.$refs.ddm.hide(),setTimeout(()=>{"cascader"!=this.field.type&&(t.$el.querySelector("input").focus(),this.$refs.ddm.hide())},10)},changeVisible(e){t.ddmVisible=e}},template:'<x-dropdown ref="ddm" :options="options" :selected="selIdxes" :type="field.type" :pinyin-searchable="field.pinyinSearchable" @update:visible="changeVisible" @select="changeVal"/>'});this.ddm=s.$refs.ddm,this.ddm.bindAlign(this.$el)}this.ddm.show()}}},Q={mixins:[J],methods:{initSelect(){let t=[];if("cascader"==this.field.type){let e=this.options;for(let s of this.value){let i=!1;for(let l=0,o=e.length;l<o;l++)if(s==e[l].value){i=!0,t.push(l),e=e[l].options;break}if(!i)break}}else for(let e=0,s=this.options.length;e<s;e++)if(this.value==this.options[e].value){t=[e];break}this.selIdxes=t},enterSelect(){this.ddm.select()},doFilter(){this.filterTimer&&(clearTimeout(this.filterTimer),this.filterTimer=null),this.filterTimer=setTimeout(()=>{this.showDdm(),this.ddm&&this.ddm.filter(this.text)},100)},focus(){this.showDdm()}}},Z=(s(25),r(Q,H,[],!1,null,null,null));Z.options.__file="src/form/Combobox.vue";var G=Z.exports,tt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"st-cbb",on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"st-cbb-item-list"},[t._l(t.selIdxes,(function(e,i){return s("div",{key:e+"_"+t.options[e].value,staticClass:"st-cbb-item st-cbb-selected",class:{"st-cbb-item-hl":i==t.hlDelIndex},style:{"max-width":t.maxSelLabelWidth+"px"}},[s("span",{staticClass:"st-cbb-item-text",domProps:{textContent:t._s(t.options[e].text)}}),t._v(" "),s("span",{staticClass:"st-cbb-item-del",on:{click:function(s){return t.del(e)}}},[t._v("✕")])])})),t._v(" "),s("div",{staticClass:"st-cbb-item st-cbb-input-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"st-form-input",attrs:{type:"text",name:t.field.name,autocomplete:"off",placeholder:0==t.selIdxes.length&&t.placeholder},domProps:{value:t.text},on:{focus:function(e){t.focus(),t.$emit("fieldfocus")},blur:function(e){t.$emit("fieldblur"),t.hlDelIndex=-1},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.hlNext(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.hlPre(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:t.hlDelPre(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])||"button"in e&&2!==e.button?null:t.hlDelNext(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.enterSelect(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.deleteSelect(e)}],input:function(e){e.target.composing||(t.text=e.target.value)}}}),t._v(" "),s("span",{staticClass:"st-cbb-input-mirror",domProps:{textContent:t._s(t.text+"A")}})])],2),t._v(" "),t.loading?t._e():s("div",{staticClass:"st-cbb-trigger st-icon st-icon-left",class:{"st-cbb-trigger-down":t.ddmVisible}}),t._v(" "),t.loading?s("span",{staticClass:"st-icon st-icon-sync st-cbb-load"}):t._e()])};tt._withStripped=!0;var et={mixins:[J],data:()=>({maxSelLabelWidth:0,hlDelIndex:-1}),watch:{text(){this.showDdm(),this.upadteInputWidth(),this.filterTimer&&(clearTimeout(this.filterTimer),this.filterTimer=null),this.filterTimer=setTimeout(()=>{this.ddm&&this.ddm.filter(this.text)},100)},selIdxes(t){t.length<=0?this.$el.querySelector("input").style.width=this.maxInputLength+"px":this.upadteInputWidth()}},mounted(){let t=this.$el.querySelector(".st-form-input"),e=window.getComputedStyle(t),s=this.$el.querySelector(".st-cbb-input-mirror");["fontFamily","fontSize","letterSpacing"].forEach(t=>{s.style[t]=e[t]});let i=this.$el.querySelector(".st-cbb-input-box"),l=window.getComputedStyle(i);this.maxInputLength=this.$el.querySelector(".st-cbb-item-list").clientWidth-parseInt(l.paddingLeft)-parseInt(l.paddingRight),this.maxSelLabelWidth=this.$el.querySelector(".st-cbb-item-list").clientWidth-4,this.upadteInputWidth()},methods:{initSelect(){let t=[],e=this.value;Array.isArray(e)||(e=[e]);for(let s=0,i=this.options.length;s<i;s++)e.includes(this.options[s].value)&&t.push(s);this.selIdxes=t,(this.selIdxes.length<=0||this.loading)&&(this.$el.querySelector("input").style.width=this.maxInputLength+"px")},focus(){this.showDdm(),this.hlDelIndex=-1},upadteInputWidth(){this.$nextTick(()=>{let t=this.$el.querySelector(".st-cbb-input-mirror").clientWidth;(t>this.maxInputLength||this.selIdxes.length<=0||this.loading)&&(t=this.maxInputLength),this.$el.querySelector("input").style.width=t+"px"})},enterSelect(){this.ddm&&this.ddm.select()},deleteSelect(){this.text||(this.hlDelIndex<0?this.hlDelIndex=this.selIdxes.length-1:(this.selIdxes=this.selIdxes.filter((t,e)=>e!=this.hlDelIndex),this.selIdxes.length<0?this.hlDelIndex=-1:this.hlDelIndex>=this.selIdxes.length&&(this.hlDelIndex=this.selIdxes.length-1)))},hlDelPre(){if(this.hlDelIndex<0){if(this.text)return;if(this.selIdxes.length>0)return void(this.hlDelIndex=this.selIdxes.length-1)}let t=this.hlDelIndex-1;t<0&&(t=this.selIdxes.length-1),this.hlDelIndex=t},hlDelNext(){if(this.hlDelIndex<0){if(this.text)return;if(this.selIdxes.length>0)return void(this.hlDelIndex=0)}let t=this.hlDelIndex+1;t>=this.selIdxes.length&&(t=0),this.hlDelIndex=t},del(t){this.changeVal(t)}}},st=(s(26),r(et,tt,[],!1,null,null,null));st.options.__file="src/form/Multiple.vue";var it=st.exports,lt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"st-up-box"},[t._l(t.files,(function(e,i){return s("div",{key:i,staticClass:"st-up-item"},[s("div",{staticClass:"st-up-item-img"},[s("img",{attrs:{src:t.isImage?e.imgUrl:t.imgPlaceholder}})]),t._v(" "),s("div",{staticClass:"st-up-file-name",domProps:{textContent:t._s(e.name)}}),t._v(" "),s("span",{staticClass:"st-icon st-icon-close st-up-del-btn",on:{click:function(e){return t.remove(i)}}}),t._v(" "),"progress"==e.status?s("div",{staticClass:"st-up-progress"},[s("div",{staticClass:"st-up-progress-bg",style:{width:e.percent+"%"}}),t._v(" "),s("div",{staticClass:"st-up-progress-txt",domProps:{textContent:t._s(t.locale.uploadProgress+"："+e.percent+"%")}})]):"load"==e.status?s("div",{staticClass:"st-up-progress st-up-progress-loaded"},[s("span",{staticClass:"st-icon st-icon-check"}),t._v(" "+t._s(t.locale.uploadDone)+"\n\t\t")]):"error"==e.status?s("div",{staticClass:"st-up-progress st-up-progress-error"},[s("span",{staticClass:"st-icon st-icon-close"}),t._v(" "+t._s(t.locale.uploadFail)+"\n\t\t")]):t._e()])})),t._v(" "),t.files.length<=0||t.field.upload.multiple?s("label",{staticClass:"st-up-item"},[s("span",{staticClass:"st-icon st-icon-cloud-upload st-up-icon"}),t._v(" "),s("input",{staticClass:"st-up-input",attrs:{accept:t.isImage?"image/*":"*/*",type:"file"},on:{change:t.upload}})]):t._e()],2)};lt._withStripped=!0;var ot=s(18),rt={mixins:[N],props:{value:{type:String,default:""},field:{type:Object,default:()=>({})}},inject:{locale:{default:s.n(ot).a}},data(){let t=this.field.upload,e=t.isImage||!1,s=[];return s=this.value?Array.isArray(this.val)?this.val.slice(0):[this.val]:[],{files:s.map(s=>{let i;if(t.getFileInfo)i=t.getFileInfo(s);else if("string"==typeof s)if(/^inagora-public:(.+)/.test(s))i={imgUrl:"https://ossimg.wandougongzhu.cn/"+RegExp.$1+"@120w_120h_1l_30Q_1wh_1pr.jpg",name:s,value:s};else{let t=s.split("/").pop();i={imgUrl:e?s:"",name:t,value:s}}else i=s;return Object.assign({status:"ok"},i)}),isImage:e,imgPlaceholder:"data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAehJREFUeNrs3D9PwkAcxvFrKXUhCAMEAhsbL8nJxElfgYPR+CZ0MnHyJbEwMkDoQGAG6h2CNlIo16t/cvd9kktL2g73ye9a7gj14jgWJH88AAH8v4CDwSCUm3vZLmXr2NLpTrf7LDc3p55/Xq0ePBZkXPtYq9Vu6/W6CILACrzhcCii6fS60WwKHcS8gFcKz/d9sV6vrRl2rXZbTMbjQhD9jOMNhWdbzsJwg6gqUX58+klAa1MUorOARSE6DVgEovOApogAGiICaIgIoCEigIaIWXPhuNfrWYUTRZFYLBZa1/T7fS/vVM66yLm9qFQqH9Xjfbkc2h+NRgzhZMrl8ufCSHL05V3Wc64Cd4gqq9Vqr+oOVSKAKYgKaLlcbra6cM4Dbjq/HcrJpTpdSOe/xijEUqm0N4y/VyUVeCQ7QFWJafdCAE9EVGjJpzFDWDNq9V23AgFMQdT5GQPAtPntiQ8Q7oEZiFTgLyACaHrPhABAAAEEkAAIIIAAEgABBBBAAiCAAAJIAAQQQAAJgAACCCABEEAAASQAAggggARAAAEEkAAIIIAAEgABBNBywCj5bhXXsu17ZAL4MpvNhIuIqs+q7zKvx87L+sP1w3w+D2W7kPstxwwnsr3JdnfsJF4FbxgAAfzbvAswAK/3kejP2oZLAAAAAElFTkSuQmCC"}},methods:{upload(t){if(!t||!t.target.files||t.target.files.length<=0)return;let e=this.field.upload,s=t.target.files[0],i=new FormData;if(i.append("file",s),window._token&&i.append("_token",window._token),e.formData){let t;t="function"==typeof e.formData?e.formData(s):e.formData;for(let e in t)i.append(e,t[e])}let l="";if(this.isImage&&/image/i.test(s.type))try{l=window.URL.createObjectURL(s)}catch(t){}var o={status:"progress",percent:0,imgUrl:l,name:s.name,value:""};this.files.push(o);let r=new XMLHttpRequest;r.upload.addEventListener("progress",(function(t){let e=Math.floor(100*t.loaded/t.total);e=e<0?0:e>100?100:e,o.percent=e}),!1),r.addEventListener("load",t=>{o.status="load";let s=JSON.parse(t.target.responseText);if(s.errno)alert(s.errmsg);else{let t;t=e.formatResult?e.formatResult(s,this.fieldConf):s.data.url,o.value=t,this.syncFileVal()}},!1),r.addEventListener("error",(function(){o.status="error"}),!1),r.addEventListener("abort",(function(){}),!1),r.open("POST",e.url),window._csrf_key&&r.setRequestHeader(window._csrf_key,window._csrf_token||""),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.send(i),o.xhr=r,t.target.value=""},remove(t){if(this.files[t]){let e=this.files.splice(t,1);e.length>0&&e[0].xhr&&e[0].xhr.abort(),this.syncFileVal()}},syncFileVal(){let t=!1,e=this.files.map(e=>("progress"==e.status&&(t=!0),"ok"==e.status||"load"==e.status?e.value:""));this.field.upload.multiple?this.$emit("input",e):this.$emit("input",e.length>0?e[0]:""),this.$emit("update:loading",t)}}},at=(s(27),r(rt,lt,[],!1,null,null,null));at.options.__file="src/form/File.vue";var nt=at.exports,dt={components:{XInput:W},props:{labelWidth:{type:Number,default:150},fieldList:{type:[Array,Object],required:!0},labelVisible:{type:Boolean,default:!0},msgTarget:{type:String,default:"under"},size:{type:String,default:"medium"},inline:{type:[Boolean,String],default:!1}},data(){let{fields:t,formData:e}=this.format(this.fieldList),s={};return this.inline||(s={width:this.labelWidth+"px"}),{fields:t,formData:e,labelStyle:s,coms:{text:W,datetime:W,date:W,number:W,combobox:G,cascader:G,multiple:it,file:nt}}},watch:{fieldList:{deep:!0,handler(t){let{fields:e}=this.format(t);this.fields=e}}},methods:{format(t){if(!Array.isArray(t)){let e=[];for(let s in t){let i=t[s];"string"==A(i)&&(i={label:i}),i.name=s,e.push(i)}t=e}let e={},s=t.map(t=>{"string"==A(t)&&(t={label:t,name:t});let s="";void 0!==(t=Object.assign({errmsg:""},t)).default_val&&(s=t.default_val),void 0!==t.default_value&&(s=t.default_value),void 0!==t.value&&(s=t.value),e[t.name]=s,t.label||(t.label=t.name),t.placeholder||(t.placeholder=t.label),t.list&&(t.options=t.list),t.asyncList&&(t.options=t.asyncList),t.options&&(t.type||(t.type="combobox")),"cascader"==t.type&&(t.filterable=!1),"select"==t.type&&(t.type="combobox"),"combobox"==t.type&&void 0===t.filterable&&(t.filterable=!0),t.type||(t.buttons?t.type="button":t.type="text"),"file"==t.type&&(t.upload=t.upload||t.uploadConfig||{},t.loading=!1),t._st_focus=!1,"number"==A(t.width)?t.width=t.width+"px":"string"==A(t.width)&&/^\d+$/.test(t.width.trim())&&(t.width=t.width.trim()+"px");let i=A(t.width);if("undefined"!=i){let e=t.width;("number"==i||"string"==i&&/^[\d.]+$/.test(e.trim()))&&(e+="px"),t.style=Object.assign({},t.style,{width:e})}return t.msg="",t.rules||(t.rules=[]),t.rules.forEach(t=>{t.trigger||(t.trigger="blur")}),t});return{formData:e,fields:s}},submit(){this.validateAll()&&this.$emit("submit",this.formData)},validateAll(){let t=!0;for(let e in this.$refs)for(let s of this.$refs[e])s.validate()||(t=!1);return t},reset(){let t={};this.fields.forEach(e=>{t[e.name]=e.value}),this.formData=t},getFormData(){return this.formData},showErrmsg(t,e){if(!this.inline)return;if(!this.errFly){let t=document.createElement("div");t.className="st-form-fly-errmsg",document.body.appendChild(t),this.errFly=t}if(!t)return void this.hideErrmsg();this.errFly.innerHTML=t,this.errFly.style.display="block";let s=e.target.getBoundingClientRect(),i=this.errFly.getBoundingClientRect(),l=document.documentElement,o=0,r=0,a="b",n="l",d={b:"st-form-fly-b",t:"st-form-fly-t",l:"st-form-fly-l",r:"st-form-fly-r"};s.bottom+i.height<l.clientHeight?r=s.bottom+7:(r=s.top-i.height-7,a="t"),s.left+i.width<l.clientWidth?o=s.left:(o=s.right-i.width,n="r"),this.errFly.style.left=o+"px",this.errFly.style.top=r+"px",this.errFly.className="st-form-fly-errmsg "+d[a]+" "+d[n]},hideErrmsg(){this.errFly&&(this.errFly.style.display="none")},updateErrmsg(t,e){t.errmsg=e,!e&&this.errFly&&"block"==this.errFly.style.display&&(this.errFly.style.display="none")}}},ct=(s(28),r(dt,O,[],!1,null,null,null));ct.options.__file="src/form/index.vue";var ht=ct.exports,ut={components:{XButton:v},inject:{title:"title",toolbar:{default:[]},addUrl:"addUrl",addConfig:"addConfig",batDeleteUrl:{default:""},downloadable:"downloadable",actionMethods:"actionMethods",store:"store",idIndex:"idIndex",ajax:"ajax",locale:"locale"},data(){let t=this,e=[];return this.toolbar&&Array.isArray(this.toolbar)&&(e=Array.from(this.toolbar)),(this.addUrl||this.batDeleteUrl||this.downloadable)&&(e.length>0&&e.unshift("|"),"all"!=this.downloadable&&!0!==this.downloadable||e.unshift({type:"primary",text:this.locale.toolbar.exportAllBtnText,icon:"st-icon st-icon-download",click(){t.downloadAll()}}),"single"!=this.downloadable&&!0!==this.downloadable||e.unshift({type:"primary",text:this.locale.toolbar.exportBtnText,icon:"st-icon st-icon-download",click(){t.download()}}),this.batDeleteUrl&&e.unshift({type:"danger",text:"批量删除",icon:"st-icon st-icon-delete",click(){t.batDelete()}}),this.addUrl&&e.unshift({type:"success",text:"添加",icon:"st-icon st-icon-plus",click(){t.add()}})),{btns:e}},mounted(){this.downloadable&&y("https://cdn.jsdelivr.net/npm/xlsx@0.15.0/dist/xlsx.full.min.js")},methods:{triggerClick(t,e){t.click&&t.click.call(this.$parent,t,e)},add(){let t=this;R({title:this.locale.add,width:600,height:"62%",html:'<x-form id="_st_add_form" size="medium" :field-list="fields" :default-values="params" label-width="100px" :label-width="100" :action-methods="actionMethods" @submit="create"></x-form>',buttons:[{text:this.locale.add,nativeType:"submit",form:"_st_add_form",type:"success"},{text:this.locale.cancel,click(){this.close()}}],components:{XForm:ht},data:{fields:this.addConfig,params:{},actionMethods:this.actionMethods},methods:{create(e){let s=t.store.emit("beforeadd",e);if(!1===s)return;let i=t.addUrl;s&&(s.url&&(i=s.url),s.data&&(e=s.data)),t.ajax.request({url:i,data:e,method:t.actionMethods.create}).then(s=>{0==s.errno?(M.success(t.locale.toolbar.addSuccessMsg),this.destroy(),t.store.$emit("load"),t.store.emit("add",s,e)):M.error(s.errmsg)})}}})},batDelete(){let t=this.$parent.getSelected();if(!t||t.length<=0)return void M.error("请选择要删除的行");if(!this.idIndex)return void M.error("没有设置参数idIndex");if(!1===this.store.emit("beforebatdelete",t))return;let e=t.map(t=>t[this.idIndex]);this.ajax.request({url:this.batDeleteUrl,data:{[this.idIndex]:e},method:this.actionMethods.delete}).then(e=>{e.errno?M.error(e.errmsg):(M.success("删除成功"),this.store.emit("batdelete",e,t))})},download(){let t=this.store.getCurrentPage(),e=this.store.emit("beforeexport",t);!1!==e&&(Array.isArray(e)&&(t=e),this.export(t))},downloadAll(){this.store.getAllPages().then(t=>{let e=this.store.emit("beforeexport",t);!1!==e&&(Array.isArray(e)&&(t=e),this.export(t))})},export(t){let e=this.$parent.$refs.table[0],s=[].concat(e.leftColumns).concat(e.freeColumns).concat(e.rightColumns);s=s.filter(t=>["text","render"].includes(t.type));let i=[],l=[],o=[];s.forEach(t=>{i.push(t.text),l.push({wpx:t._st_width})}),o.push(i);for(let e of t){let t=[];for(let i of s){let s=i.dataIndex,l=e[s];"render"==i.type&&(l=e._st_aux.render[s],"string"==typeof l&&(l=l.replace(/(<([^>]+)>)/gi,"").trim())),"number"!=typeof l&&"number"==i.exportType&&("string"==typeof l&&(l=l.replace(/,/g,"")),l=Number(l)),t.push(l)}o.push(t)}let r=XLSX.utils.book_new(),a=prompt(this.locale.toolbar.confirmFileName,this.title||"data");a=(a||"stable").trim(),a.includes(".")||(a+=".xlsx");let n=XLSX.utils.aoa_to_sheet(o);n["!cols"]=l,XLSX.utils.book_append_sheet(r,n,"Sheet1"),XLSX.writeFile(r,a)}}},pt=(s(29),r(ut,p,[],!1,null,null,null));pt.options.__file="src/Toolbar.vue";var ft=pt.exports,mt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.searchFilter?s("div",{staticClass:"st-search",class:{"st-search-label-invisible":!t.labelVisible}},[s("x-form",{ref:"form",attrs:{inline:"","field-list":t.searchFilter,size:"small","label-visible":t.labelVisible},on:{submit:t.search}},[s("x-button",{attrs:{conf:{nativeType:"submit",type:"primary",icon:"st-icon st-icon-search",text:t.locale.search}}}),t._v(" "),t.searchResetable?s("x-button",{attrs:{conf:{cls:"st-search-reset-btn",text:t.locale.reset}},on:{click:function(e){return e.preventDefault(),t.reset(e)}}}):t._e()],1)],1):t._e()};mt._withStripped=!0;var gt={components:{XButton:v,XForm:ht},inject:["searchFilter","searchResetable","labelVisible","listeners","actionMethods","urlSearchParams","params","store","ignoreEmptySearchParam","locale"],methods:{search(t){let e=Object.assign({},this.urlSearchParams,t);this.ignoreEmptySearchParam&&(e=this.trimParam(e)),!1!==this.store.emit("search",e)&&(this.store.searchParams=e,this.store.$emit("load",{reset:!0}))},reset(){this.$refs.form.reset()},trimParam(t){let e={};for(let s in t)"string"==typeof t[s]?t[s]&&(e[s]=t[s]):void 0!==t[s]&&(e[s]=t[s]);return e}}},bt=(s(30),r(gt,mt,[],!1,null,null,null));bt.options.__file="src/Search.vue";var vt=bt.exports,xt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"st-table",class:{"st-table-left-shadow":t.leftShadow,"st-table-right-shadow":t.rightShadow,"st-table-firefox":t.isFirefox}},[s("div",{staticClass:"st-table-head-area"},[s("x-head",{attrs:{locked:"left",columns:t.leftColumns,"table-width":t.totalLeftWidth},on:{dragprepare:t.prepareDrag,drag:t.drag,drop:t.drop,resizestart:t.startResize,menushow:t.showMenu}}),t._v(" "),s("x-head",{attrs:{locked:!1,columns:t.freeColumns,"table-width":t.totalFreeWidth},on:{dragprepare:t.prepareDrag,drag:t.drag,drop:t.drop,resizestart:t.startResize,menushow:t.showMenu}}),t._v(" "),s("x-head",{attrs:{locked:"right",columns:t.rightColumns,"table-width":t.totalRightWidth},on:{dragprepare:t.prepareDrag,drag:t.drag,drop:t.drop,resizestart:t.startResize,menushow:t.showMenu}})],1),t._v(" "),s("div",{staticClass:"st-table-body-area"},[s("div",{staticClass:"st-table-body-panel"},[s("x-body",{attrs:{locked:"left",columns:t.leftColumns,"record-list":t.recordList,"records-height":t.recordsHeight,"table-width":t.totalLeftWidth}}),t._v(" "),s("x-body",{attrs:{locked:!1,columns:t.freeColumns,"record-list":t.recordList,"records-height":t.recordsHeight,"table-width":t.totalFreeWidth}}),t._v(" "),s("x-body",{attrs:{locked:"right",columns:t.rightColumns,"record-list":t.recordList,"records-height":t.recordsHeight,"table-width":t.totalRightWidth}})],1)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.fakeVisible,expression:"fakeVisible"}],staticClass:"st-fake-scrollbar"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.leftColumns.length>0,expression:"leftColumns.length>0"}],staticClass:"st-fake-left"},[s("div",{staticClass:"st-fake-content",style:{width:t.totalLeftWidth+"px"}})]),t._v(" "),s("div",{staticClass:"st-fake-free"},[s("div",{staticClass:"st-fake-content",style:{width:t.totalFreeWidth+"px"}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.rightColumns.length>0,expression:"rightColumns.length>0"}],staticClass:"st-fake-right"},[s("div",{staticClass:"st-fake-content",style:{width:t.totalRightWidth+"px"}})])]),t._v(" "),t.resizing?s("div",{staticClass:"st-table-resize",style:{left:t.startResizePos+"px"}}):t._e(),t._v(" "),t.resizing?s("div",{staticClass:"st-table-resize",style:{left:t.endResizePos+"px"}}):t._e(),t._v(" "),s("x-flyman",{attrs:{visible:t.flymanVisible}})],1)};xt._withStripped=!0;var yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.columns.length>0?s("div",{staticClass:"st-table-head-box",class:{"st-table-head-left":"left"==t.locked,"st-table-head-right":"right"==t.locked,"st-table-head-free":!t.locked}},[s("table",{staticClass:"st-table-head",style:{width:t.tableWidth+"px"}},[s("thead",[s("tr",{staticClass:"st-table-head-tr"},t._l(t.columns,(function(e,i){return s("th",{key:i,staticClass:"st-table-head-th",class:[e.cls,{"st-table-head-th-hover":e._hl}],style:[e.style,{width:e._st_width+"px"}]},["radio"==e.type?s("div",{staticClass:"st-table-cell"},[s("div",{staticClass:"st-table-head-text"},[t._v("\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t")])]):"checkbox"==e.type?s("div",{staticClass:"st-table-cell st-table-label-cell st-table-checkbox-cell"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.store.chkAll,expression:"store.chkAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.store.chkAll)?t._i(t.store.chkAll,null)>-1:t.store.chkAll},on:{change:function(e){var s=t.store.chkAll,i=e.target,l=!!i.checked;if(Array.isArray(s)){var o=t._i(s,null);i.checked?o<0&&t.$set(t.store,"chkAll",s.concat([null])):o>-1&&t.$set(t.store,"chkAll",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.store,"chkAll",l)}}}),t._v(" "),s("span",{staticClass:"st-table-checkbox-mask",on:{click:function(e){return t.store.$emit("selectall",!t.store.chkAll)}}})]):"rownumber"==e.type?s("div",{staticClass:"st-table-cell"},[s("div",{staticClass:"st-table-head-text st-table-cell-wrap",domProps:{textContent:t._s(e.text)}})]):"pad"==e.type?[e._width>0?s("div",{staticClass:"st-table-cell"},[t._v("\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t")]):t._e()]:[s("div",{staticClass:"st-table-cell",class:{"st-table-head-sortable":e.sortable},attrs:{title:e.text},on:{mousedown:function(s){return t.$emit("dragprepare",e)},mousemove:function(s){return t.$emit("drag",{column:e,evt:s})},mouseup:function(s){return t.$emit("drop",{column:e,evt:s})},click:function(s){return t.sort(e)}}},[s("div",{staticClass:"st-table-head-text st-table-cell-wrap",domProps:{textContent:t._s(e.text||"&nbsp;")}}),t._v(" "),e.sortable?s("div",{staticClass:"st-table-head-sort-icon st-icon",class:[t.store.sortKey==e.dataIndex?"asc"==t.store.sortDirection?"st-icon-arrowdown st-table-head-sorting":"st-icon-arrowdown st-table-head-sorting-desc":"st-icon-swap"]}):t._e()]),t._v(" "),s("div",{staticClass:"st-icon st-icon-caret-down st-table-head-menu-btn",on:{click:function(s){return t.$emit("menushow",{column:e,evt:s})}}}),t._v(" "),e.resizable?s("div",{staticClass:"st-table-head-resizer",on:{mousedown:function(s){return t.$emit("resizestart",{column:e,evt:s})}}}):t._e()]],2)})),0)])])]):t._e()};yt._withStripped=!0;var _t={props:{locked:{type:[Boolean,String],required:!0},columns:{type:Array,required:!0},tableWidth:{type:Number,default:0},recordsHeight:{type:Array,default:()=>[]}},inject:["store","sortDirection"],methods:{sort(t){t.sortable&&(this.store.sortKey==t.dataIndex?this.store.sortDirection="asc"==this.store.sortDirection?"desc":"asc":(this.store.sortKey=t.dataIndex,this.store.sortDirection=this.sortDirection))}}},wt=(s(31),r(_t,yt,[],!1,null,null,null));wt.options.__file="src/table/Head.vue";var Ct=wt.exports,kt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.columns.length>0,expression:"columns.length>0"}],staticClass:"st-table-body-box",class:{"st-table-body-left":"left"==t.locked,"st-table-body-right":"right"==t.locked,"st-table-body-free":!t.locked},on:{mousedown:t.blur}},[s("table",{staticClass:"st-table-body",style:{width:t.tableWidth+"px"}},[t._l(t.columns,(function(t,e){return s("col",{key:e,attrs:{width:t._st_width}})})),t._v(" "),s("tbody",t._l(t.recordList,(function(e,i){return s("tr",{key:i,staticClass:"st-table-body-tr",class:{"st-table-body-tr-hl":i==t.store.hlRowNum,"st-table-body-tr-focus":i==t.store.focusRowNum},style:{height:t.recordsHeight[i]},on:{mouseenter:function(e){t.store.hlRowNum=i},mousedown:function(e){t.store.focusRowNum=i},click:function(s){return t.store.emit("rowclick",e,s)}}},t._l(t.columns,(function(l,o){return s("td",{key:o,staticClass:"st-table-body-td",class:[l.cls,{"st-table-td-rownumber":"rownumber"==l.type}],style:l.style,on:{click:function(s){t.cellClick(e,l,s),t.store.emit("cellclick",e,l,s)}}},["radio"==l.type?s("label",{staticClass:"st-table-label-cell st-table-cell"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.store.radioVal,expression:"store.radioVal"}],attrs:{type:"radio"},domProps:{value:i,checked:t._q(t.store.radioVal,i)},on:{change:function(e){return t.$set(t.store,"radioVal",i)}}})]):"checkbox"==l.type?s("label",{staticClass:"st-table-label-cell st-table-cell"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.store.checkboxVal,expression:"store.checkboxVal"}],attrs:{type:"checkbox"},domProps:{value:i,checked:Array.isArray(t.store.checkboxVal)?t._i(t.store.checkboxVal,i)>-1:t.store.checkboxVal},on:{change:function(e){var s=t.store.checkboxVal,l=e.target,o=!!l.checked;if(Array.isArray(s)){var r=i,a=t._i(s,r);l.checked?a<0&&t.$set(t.store,"checkboxVal",s.concat([r])):a>-1&&t.$set(t.store,"checkboxVal",s.slice(0,a).concat(s.slice(a+1)))}else t.$set(t.store,"checkboxVal",o)}}})]):"rownumber"==l.type?s("div",{staticClass:"st-table-cell",domProps:{textContent:t._s(e._st_aux.rownumber)}}):"text"==l.type?[t.sublistAt.includes(l.dataIndex)?t._l(e[l.dataIndex],(function(e,i){return s("div",{key:i,staticClass:"st-table-cell",class:{"st-table-cell-nowrap":!l.cellWrap},domProps:{textContent:t._s(e)}})})):s("div",{staticClass:"st-table-cell",class:{"st-table-cell-nowrap":!l.cellWrap},domProps:{textContent:t._s(e[l.dataIndex])}})]:"render"==l.type?s("div",{staticClass:"st-table-cell",class:{"st-table-cell-nowrap":!l.cellWrap},domProps:{innerHTML:t._s(e._st_aux.render[l.dataIndex])}}):"button"==l.type?s("div",{staticClass:"st-table-btn-box st-table-cell"},[t._l(l.buttons,(function(i,o){return[e._st_aux.btnsVisible[l.dataIndex][o]?s("x-button",{key:o,attrs:{conf:i},on:{click:function(s){return t.btnClick(i,e,s)}}}):t._e()]}))],2):"option"==l.type?s("div",{staticClass:"st-table-cell",class:{"st-table-cell-nowrap":!l.cellWrap},domProps:{textContent:t._s(e._st_aux.option[l.dataIndex])}}):t._e()],2)})),0)})),0)],2)])};kt._withStripped=!0;var It={inject:["store","sublistAt","layoutMode"],components:{XButton:v},props:{locked:{type:[Boolean,String],default:!1},columns:{type:Array,required:!0},recordList:{type:Array,required:!0},tableWidth:{type:Number,required:!0},recordsHeight:{type:Array,required:!0}},methods:{btnClick(t,e,s){t.click&&t.click.call(this.$parent.$parent,e,t,s)},blur(t){t.target.classList.contains("st-table-body-box")&&(this.store.focusRowNum=-1)},cellClick(t,e,s){e.click&&e.click.call(this.$parent.$parent,t,e,s)}}},St=(s(32),r(It,kt,[],!1,null,null,null));St.options.__file="src/table/Body.vue";var At=St.exports,$t=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"st-table-menu-box",style:{left:t.left+"px",top:t.top+"px"},on:{click:function(t){t.stopPropagation()}}},[s("div",{staticClass:"st-table-menu"},[t.curIdx>=0?[s("div",{staticClass:"st-table-menu-item",on:{click:function(e){return t.toggleVisible(t.curIdx)},mouseenter:function(e){return t.showSubmenu("")}}},[s("i",{staticClass:"st-icon",class:[t.list[t.curIdx].visible?"st-icon-eye":"st-icon-eye-close"]}),t._v(" "),s("span",{domProps:{textContent:t._s(t.list[t.curIdx].text)}})]),t._v(" "),s("div",{staticClass:"st-table-menu-item",class:{"st-table-menu-item-hover":"lock"==t.submenu},on:{mouseenter:function(e){return t.showSubmenu("lock",e)}}},[s("i",{staticClass:"st-icon st-icon-lock"}),t._v(" "),s("span",[t._v("冻结位置")]),t._v(" "),s("i",{staticClass:"st-icon st-icon-caret-down st-table-menu-more"})])]:t._e(),t._v(" "),s("div",{staticClass:"st-table-menu-item",class:{"st-table-menu-item-hover":"column"==t.submenu},on:{mouseenter:function(e){return t.showSubmenu("column",e)}}},[s("i",{staticClass:"st-icon st-icon-filter"}),t._v(" "),s("span",[t._v("列筛选")]),t._v(" "),s("i",{staticClass:"st-icon st-icon-caret-down st-table-menu-more"})])],2),t._v(" "),"lock"==t.submenu?s("div",{staticClass:"st-table-menu st-table-submenu"},[s("div",{staticClass:"st-table-menu-item",on:{click:function(e){return t.lock("left")}}},[s("i",{staticClass:"st-icon",class:{"st-icon-check-square st-table-menu-selected":"left"==t.list[t.curIdx].locked,"st-icon-border":"left"!=t.list[t.curIdx].locked}}),t._v(" "),s("span",[t._v("左侧")])]),t._v(" "),s("div",{staticClass:"st-table-menu-item",on:{click:function(e){return t.lock("right")}}},[s("i",{staticClass:"st-icon",class:{"st-icon-check-square st-table-menu-selected":"right"==t.list[t.curIdx].locked,"st-icon-border":"right"!=t.list[t.curIdx].locked}}),t._v(" "),s("span",[t._v("右侧")])]),t._v(" "),s("div",{staticClass:"st-table-menu-item",on:{click:function(e){return t.lock(!1)}}},[s("i",{staticClass:"st-icon",class:{"st-icon-check-square st-table-menu-selected":!t.list[t.curIdx].locked,"st-icon-border":t.list[t.curIdx].locked}}),t._v(" "),s("span",[t._v("不冻结")])])]):t._e(),t._v(" "),"column"==t.submenu?s("div",{staticClass:"st-table-menu st-table-submenu"},t._l(t.list,(function(e,i){return s("div",{key:e.text+i,staticClass:"st-table-menu-item",on:{click:function(e){return t.toggleVisible(i)}}},[s("i",{staticClass:"st-icon",class:[e.visible?"st-icon-check-square st-table-menu-selected":"st-icon-border"]}),t._v(" "),s("span",{domProps:{textContent:t._s(e.text)}})])})),0):t._e()])};$t._withStripped=!0;let Pt=document.documentElement;var Et={inject:["store"],data:()=>({list:[],curIdx:-1,visible:!1,left:-1e3,top:-1e3,submenu:""}),mounted(){let t=this;this.hide=function(){t.visible=!1,t.store.columns[t.curIdx]._hl=!1,Pt.removeEventListener("click",t.hide,!1)}},methods:{show(t){if(this.visible)return;Pt.removeEventListener("click",this.hide,!1);let e=t.column._st_idx,s=-1;this.list=this.store.columns.map((t,i)=>(t._st_idx==e&&(s=i),{text:t.text,visible:t.visible,locked:t.locked})),this.curIdx=s,this.visible=!0,this.submenu="",this.store.columns[this.curIdx]._hl=!0,this.$nextTick(()=>{this.adjust(t.evt)}),setTimeout(()=>{Pt.addEventListener("click",this.hide,!1)},1e3)},adjust(t){let e=t.target.closest(".st-table-head-th").querySelector(".st-table-head-menu-btn").getBoundingClientRect(),s=this.$el.getBoundingClientRect();e.left+s.width<Pt.clientWidth?this.left=e.left:this.left=e.right-s.width,this.top=e.bottom},showSubmenu(t,e){this.submenu=t,t&&this.$nextTick(()=>{let t=e.target.closest(".st-table-menu-item").getBoundingClientRect(),s=this.$el.querySelector(".st-table-submenu"),i=s.getBoundingClientRect(),l=this.$el.getBoundingClientRect(),o=0,r=0;o=t.right+i.width<Pt.clientWidth?t.width:-i.width,r=t.top+i.height<Pt.clientHeight?t.top-l.top:t.bottom-i.height-l.top,s.style.left=o+"px",s.style.top=r+"px"})},toggleVisible(t){if(this.store.columns[t].visible){let t=0;for(let e of this.store.columns)e.visible&&t++;if(t<=1)return}this.store.columns[t].visible=!this.store.columns[t].visible,this.list[t].visible=this.store.columns[t].visible,this.$emit("updatecolumn")},lock(t){this.store.columns[this.curIdx].locked=t,this.list[this.curIdx]=t,this.$emit("updatecolumn"),this.hide()}}},Lt=(s(33),r(Et,$t,[],!1,null,null,null));Lt.options.__file="src/table/Menu.vue";var Tt=Lt.exports,Dt=function(){var t=this.$createElement;return(this._self._c||t)("div",{directives:[{name:"show",rawName:"v-show",value:this.isLoading,expression:"isLoading"}],staticClass:"st-load"},[this._m(0),this._v(" "),this._m(1)])};Dt._withStripped=!0;var Rt={props:{visible:Boolean},data(){return{isLoading:this.visible}},watch:{visible(t){t?this.isLoading=!0:setTimeout(()=>{let t=this.$el.querySelector(".st-load-man");t.classList.add("st-load-man-out"),setTimeout(()=>{this.isLoading=!1,setTimeout(()=>{t.classList.remove("st-load-man-out")},0)},200)},0)}}},qt=(s(34),r(Rt,Dt,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"st-load-man"},[e("div",{staticClass:"st-load-body"},[e("span",{staticClass:"st-load-heart"})]),this._v(" "),e("div",{staticClass:"st-load-face"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"st-load-wind"},[e("span"),this._v(" "),e("span"),this._v(" "),e("span"),this._v(" "),e("span")])}],!1,null,null,null));qt.options.__file="src/com/FlyMan.vue";var jt=qt.exports;s(35);class zt{constructor({type:t="normal",duration:e=5e3,text:s=""}){let i=document.createElement("div");i.className="st-pb-box",i.innerHTML='<div class="st-pb-body"><progress class="st-pb" value="0" max="100"></progress><div class="st-pb-tip"></div></div>',document.body.appendChild(i),this.dom=i,"infinite"==t&&(this.duration=e,this.val=0,this.loop()),this.update(null,s)}update(t,e){if(null!=t){let e=100*t;this.dom.querySelector(".st-pb").value=e}null!=e&&(this.dom.querySelector(".st-pb-tip").innerHTML=e)}destroy(){this.dom.remove(),this.timerId&&(clearTimeout(this.timerId),this.timerId=null)}loop(){this.val++,this.val>100&&(this.val=0),this.dom.querySelector(".st-pb").value=this.val,this.timerId=setTimeout(()=>{this.loop()},this.duration/100)}}var Mt={inject:["store","records","params","url","actionMethods","pageMode","pageIndex","parallelCount","dynamicParallelCount","downloadTimeout","downloadAllFromJustOnePage","sublistAt","ajax"],data:()=>({flymanVisible:!1,recordList:[],clean:!0}),watch:{"store.page":function(){this.load()},"store.sortKey":function(){this.throttleLoad()},"store.sortDirection":function(){this.throttleLoad()},"store.loadAction":function(t,e){t!=e&&("loadPrePage"==t?this.load("pre"):"loadNextPage"==t&&this.load("next"))},"store.checkboxVal"(){let t=this.recordList.every((t,e)=>this.store.checkboxVal.includes(e));this.store.chkAll=t}},mounted(){this.store.$on("load",t=>{t&&t.reset?this.reset():this.load()}),this.store.$on("selectall",t=>{this.store.checkboxVal=t?this.recordList.map((t,e)=>e):[]}),this.store.getCurrentPage=()=>this.recordList,this.store.getAllPages=()=>"waterfall"==this.pageMode?this.getAllOnWaterfall():this.getAllOnNormal()},methods:{reset(){this.store.hasNextPage=!0,this.store.hasPrePage=!1,this.clean=!0,1==this.store.page?this.load():this.store.page=1},load(t){if(this.records)return void this.setRecords(this.records);if(this.isPageLoading)return;this.isPageLoading=!0,this.timer=setTimeout(()=>{this.flymanVisible=!0},500);let e=Object.assign({},this.params,this.store.searchParams);if(this.store.sortKey&&(e.sort_key=this.store.sortKey,e.sort_direction=this.store.sortDirection),"waterfall"==this.pageMode){let s="",i=e.count;"cur"==t?this.lastRequestParams&&(s=this.lastRequestParams[this.pageIndex],i=this.lastRequestParams.count):"pre"==t?(this.recordList&&this.recordList.length>0&&(s=this.recordList[0][this.pageIndex]),i=-i):!this.clean&&this.recordList&&this.recordList.length>0&&(s=this.recordList[this.recordList.length-1][this.pageIndex]),e.count=i,e[this.pageIndex]=s}else e.page=this.store.page;this.lastRequestParams=e;let s={url:this.url,data:e,method:this.actionMethods.read},i=this.store.emit("beforedatarequest",s);if(!1===i)return!1;i&&i.url&&(s=i),this.ajax.request(s).then(t=>{this.isPageLoading=!1,this.timer&&(clearTimeout(this.timer),this.timer=null),this.flymanVisible=!1;let s=this.store.emit("dataload",t);if(s&&(t=s),t.errno)alert(t.errmsg||t.msg);else if("waterfall"==this.pageMode){let s=e.count;this.clean||t.data.list&&!(t.data.list.length<=0)?(this.clean=!1,this.setRecords(t.data.list),t.data.list.length<Math.abs(s)&&(s>0?this.store.hasNextPage=!1:this.store.hasPrePage=!1),s<0?this.store.hasNextPage=!0:e[this.pageIndex]&&(this.store.hasPrePage=!0)):(alert((s>0?"后面":"前面")+"已没有更多数据了"),s>0?this.store.hasNextPage=!1:this.store.hasPrePage=!1)}else this.setRecords(t.data.list),this.store.pageCount=t.data.page_count||this.store.page;"waterfall"==this.pageMode&&(this.store.loadAction="")})},throttleLoad(){this.throttleTimer&&(clearTimeout(this.throttleTimer),this.throttleTimer=null),this.throttleTimer=setTimeout(()=>{this.store.$emit("load",{reset:!0})},50)},refresh(t){void 0!==t&&(t=parseInt(t,10))!=this.store.page?this.store.page=t:this.load("cur")},setRecords(t){t.forEach((t,e)=>{t._st_aux={rownumber:e+1,render:{},btnsVisible:{},option:{}}}),this.store.emit("refresh",t),t.forEach((t,e)=>{this.columns.forEach(s=>{if("render"==s.type&&s.render)t._st_aux.render[s.dataIndex]=s.render(t,s,e);else if("button"==s.type){let e=t._st_aux.btnsVisible[s.dataIndex]=[];(s.buttons||[]).forEach(s=>{let i=!0;s.visible&&(Array.isArray(s.visible)?i=t[s.visible[0]]==s.visible[1]:"function"==typeof s.visible&&(i=s.visible(t))),e.push(i)})}else if("option"==s.type){let e=s.options[t[s.dataIndex]+""];void 0===e&&(e=void 0===s.defaultOption?"":s.defaultOption),t._st_aux.option[s.dataIndex]=e}})}),this.recordList=t,this.store.$emit("selectall",!1)},getAllOnNormal(){return new Promise(t=>{let e=new zt({});e.update(0,"开始下载数据");let s=[],i=[],l=[],o=this.store.pageCount||1;this.downloadAllFromJustOnePage&&(o=1);let r=0,a=this.parallelCount,n=0,d=t=>{let r=Object.assign({},this.params,this.store.searchParams);this.store.sortKey&&(r.sort_key=this.store.sortKey,r.sort_direction=this.store.sortDirection),r.page=t,this.downloadAllFromJustOnePage&&(r.count="max");let a={url:this.url,data:r,method:this.actionMethods.read,timeout:this.downloadTimeout},d=this.store.emit("beforedatarequest",a);if(!1===d)return!1;d&&d.url&&(a=d);let h=this.ajax.request(a);return h.then(t=>{let l=this.store.emit("dataload",t);l&&(t=l),s[r.page]=t.data&&t.data.list||[],t.data&&t.data.page_count&&(o=t.data.page_count);let a=i.indexOf(h);i.splice(a,1),c(),n++;let d=100*n/o;d=d>0&&d<1?1:d>99&&d<100?99:Math.floor(d),e.update(d/100,"已下载".concat(n,"页，共").concat(o,"页"))},(function(){i.splice(i.indexOf(h),1),l.push(t),c()})),h},c=()=>{if(!(i.length>=a)){if(l.length>0){let t=l.shift();i.push(d(t)),c()}else r<o&&(r++,i.push(d(r)),c());if(l.length<=0&&i.length<=0&&r>=o){e.destroy();let i=[];for(let t=1;t<=o;t++)s[t]||alert("页面 "+t+" 数据有问题"),i=i.concat(s[t]);i.forEach((t,e)=>{t._st_aux={render:{}},this.columns.forEach(s=>{"render"==s.type&&s.render&&(t._st_aux.render[s.dataIndex]=s.render(t,s,e))})}),t(i)}}};c()})},getAllOnWaterfall(){return new Promise((t,e)=>{let s=new zt({});s.update(0,"数据下载中，请稍候...");let i=[],l=0,o=this.pageIndex,r=a=>{let n=Object.assign({},this.params,this.store.searchParams);this.store.sortKey&&(n.sort_key=this.store.sortKey,n.sort_direction=this.store.sortDirection),n[o]=a,this.downloadAllFromJustOnePage&&(n.count="max");let d={url:this.url,data:n,method:this.actionMethods.read,timeout:this.downloadTimeout},c=this.store.emit("beforedatarequest",d);if(!1===c)return!1;c&&c.url&&(d=c),this.ajax.request(d).then(d=>{let c=this.store.emit("dataload",d);c&&(d=c),d.errno?(alert(d.errmsg),e(d)):!d.data.list||d.data.list.length<=0?(i.forEach((t,e)=>{t._st_aux={render:{}},this.columns.forEach(s=>{"render"==s.type&&s.render&&(t._st_aux.render[s.dataIndex]=s.render(t,s,e))})}),t(i),s.destroy()):(i=i.concat(d.data.list),d.data.list.length<n.count||this.downloadAllFromJustOnePage?(i.forEach((t,e)=>{t._st_aux={render:{}},this.columns.forEach(s=>{"render"==s.type&&s.render&&(t._st_aux[s.dataIndex]=s.render(t,s,e))})}),t(i),s.destroy()):(a=i[i.length-1][o],r(a),l++,s.update(0,"已下载 ".concat(l," 页数据，请继续等待..."))))},()=>{setTimeout(()=>{r(a)},500)})};r("")})},getSelectRows(){if("single"!=this.selectMode)return this.store.checkboxVal.map(t=>this.recordList[t]);if("number"==typeof this.store.radioVal){let t=this.recordList[this.store.radioVal];if(t)return[t]}return[]}}};let Ot=document.documentElement;var Vt={inject:["store"],mounted(){this.dragger={startIdx:-1,moveFly:this.moveFly.bind(this),clearDrag:this.clearDrag.bind(this)}},beforeDestroy(){this.clearDrag(),this.dragger=null},methods:{prepareDrag(t){this.clearDrag(),this.dragger.startIdx=t._st_idx,Ot.addEventListener("mousemove",this.dragger.moveFly,!1),Ot.addEventListener("mouseup",this.dragger.clearDrag,!1)},initDrag(t){let e=document.createElement("div");this.dragger.fly=e,e.innerText=t.text,e.className="st-table-head-drag-fly",document.body.appendChild(e);let s=document.createElement("div");this.dragger.indicator=s,s.innerHTML='<span class="st-icon st-icon-arrowdown"></span><span class="st-table-head-indicator-bottom st-icon st-icon-arrowdown"></span>',s.className="st-table-head-indicator",document.body.appendChild(s);let i=this.$el.querySelectorAll(".st-table-head-area .st-table-head-th");this.columns.forEach((t,e)=>{let s=i[e].getBoundingClientRect();t.rect={left:s.left,right:s.right,center:(s.left+s.right)/2,top:s.top}})},moveFly(t){if(this.dragger.fly){let e=t.clientX;this.dragger.fly.clientWidth+20+e>Ot.clientWidth&&(e=Ot.clientWidth-20-this.dragger.fly.clientWidth),e+=Ot.scrollLeft;let s=Ot.scrollTop+t.clientY;this.dragger.fly.style.cssText="left:".concat(e,"px;top:").concat(s,"px")}},drag(t){if(this.dragger.startIdx<0)return;let{column:e,evt:s}=t;this.dragger.fly||this.initDrag(e);let{valid:i,pos:l,rect:o}=this.dropValidCheck(e,s);if(i){let t="before"==l?o.left:o.right;t+=Ot.scrollLeft;let e=o.top+Ot.scrollTop;this.dragger.indicator.style.cssText="left:".concat(t,"px;top:").concat(e,"px")}else this.dragger.indicator.style.cssText="left:-1000px;top:-1000px"},dropValidCheck(t,e){if(this.dragger.startIdx<0||!this.dragger.fly)return{valid:!1};let s=this.dragger.startIdx,i=t._st_idx,l=t.rect,o=this.columns[s],r=e.clientX<l.center?"before":"after",a=!1;return i>s?t.locked!=o.locked?a=!0:i-s==1?"pad"!=t.type&&"after"==r&&(a=!0):a=!0:i<s&&(t.locked!=o.locked?a=!0:i-s==-1?"before"==r&&(a=!0):a=!0),{valid:a,pos:r,rect:l,startIdx:s,targetIdx:i}},drop(t){if(this.dragger.startIdx<0)return;let{column:e,evt:s}=t,{valid:i,pos:l,startIdx:o,targetIdx:r}=this.dropValidCheck(e,s);if(i){let t=this.columns[o];t.locked=e.locked,this.store.columns.sort((t,e)=>t._st_idx-e._st_idx);let s=[];for(let e of this.store.columns)e._st_idx!=o&&(e._st_idx==r?("before"==l&&s.push(t),s.push(e),"after"==l&&s.push(t)):s.push(e));this.store.columns=s}},clearDrag(){this.dragger.startIdx=-1,this.dragger.fly&&(this.dragger.fly.remove(),this.dragger.fly=null),this.dragger.indicator&&(this.dragger.indicator.remove(),this.dragger.indicator=null),Ot.removeEventListener("drag",this.dragger.moveFly,!1),Ot.removeEventListener("mouseup",this.dragger.clearDrag,!1)}}};let Nt=document.documentElement;var Ft={components:{XHead:Ct,XBody:At,XFlyman:jt},mixins:[Mt,Vt,{data:()=>({resizing:!1,startResizePos:0,endResizePos:0}),mounted(){this._resize=this.resize.bind(this),this._resizeEnd=this.resizeEnd.bind(this)},methods:{startResize(t){this.clearResize(),t.evt.preventDefault();let e=t.evt.target.closest(".st-table-head-th").getBoundingClientRect(),s=this.$el.querySelector(".st-table-head-area").getBoundingClientRect();this.resizing=!0,this.startResizePos=e.left-s.left,this.endResizePos=e.right-s.left,this._headBoxLeft=s.left,this._resizeColumnIdx=t.column._st_idx,Nt.addEventListener("mousemove",this._resize,!1),Nt.addEventListener("mouseup",this._resizeEnd,!1)},resize(t){let e=t.clientX-this._headBoxLeft;e-this.startResizePos<25&&(e=this.startResizePos+25),this.endResizePos=e},resizeEnd(){this.clearResize();let t=this.columns[this._resizeColumnIdx]._st_idx,e=this.store.columns.map(e=>(e._st_idx==t&&(e.width=this.endResizePos-this.startResizePos),e));this.store.columns=e,this._syncHeight()},clearResize(){this.resizing=!1,Nt.removeEventListener("mousemove",this._resize,!1),Nt.removeEventListener("mouseup",this._resizeEnd,!1)}}}],inject:["store","rowNumberVisible","selectMode","layoutMode","ajax","deleteUrl","updateUrl","updateConfig","idIndex"],data:()=>({hlRowNum:-1,focusRowNum:-1,leftShadow:!1,rightShadow:!1,leftColumns:[{text:"",_st_width:0}],freeColumns:[{text:"",_st_width:0}],rightColumns:[{text:"",_st_width:0}],recordsHeight:[],totalLeftWidth:0,totalFreeWidth:0,totalRightWidth:0,fakeVisible:!1,isFirefox:C}),watch:{"store.columns":function(){this.formatColumns()},recordList:function(){this.syncHeight()}},destroyed(){this.menu&&(this.menu.$destroy(),this.menu.$el.remove(),this.menu=null)},mounted(){this.columns=[],this.formatColumns();let t=this.$el.querySelector(".st-table-body-free"),e=this.$el.querySelector(".st-fake-free"),s=this.$el.querySelector(".st-table-head-free"),i=this;t.addEventListener("scroll",(function(){let s=t.scrollLeft,l=t.clientWidth,o=t.scrollWidth;i.leftShadow=s>0,i.rightShadow=s+l<o,s!=e.scrollLeft&&(e.scrollLeft=s)}),!1),e.addEventListener("scroll",()=>{let i=e.scrollLeft;i!=t.scrollLeft&&(t.scrollLeft=i),s.scrollLeft=i},!1),this.isFirefox&&(this.$el.querySelector(".st-table-body-panel").style.width=this.$el.querySelector(".st-table-body-area").clientWidth+"px")},methods:{formatColumns(){let t=[],e=[],s=[];if(this.store.columns.forEach(i=>{i.visible&&(i.locked?"right"==i.locked?e.push(i):t.push(i):s.push(i),i._st_width=0)}),"single"==this.selectMode?t.unshift({dataIndex:"_st_aux_radio",text:"⚪",type:"radio",width:40,locked:!0}):"multiple"==this.selectMode&&t.unshift({dataIndex:"_st_aux_checkbox",text:"☑",type:"checkbox",width:40,locked:!0}),this.rowNumberVisible&&t.unshift({dataIndex:"_st_aux_rownumber",text:"#",type:"rownumber",locked:!0,width:40}),this.deleteUrl||this.updateUrl){let t=this.getOpBtns();e.push({dataIndex:"_st_aux_op",type:"button",buttons:t,width:100*t.length,text:"操作"})}s.push({dataIndex:"_st_aux_pad",type:"pad",width:0,text:" "}),this.leftColumns=t,this.freeColumns=s,this.rightColumns=e,this.columns=t.concat(s,e);for(let t=0;t<this.columns.length;t++){let e=this.columns[t];e._st_idx=t,"button"==e.type&&((e.buttons||[]).forEach(t=>{t.size=t.size||"small",t.type||(t.type="primary")}),void 0===e.width&&(e.width=100*e.buttons.length))}this.layout()},getOpBtns(){let t=[];return this.deleteUrl&&t.push({text:"删除",icon:"st-icon st-icon-close",type:"danger",click:t=>{if(!0!==confirm("您确定要删除此行数据？"))return;if(!this.idIndex)return void alert("请配置参数 idIndex");let e=t[this.idIndex],s={};s[this.idIndex]=e,Object.assign(s,this.params),this.ajax.request({url:this.deleteUrl,data:s,method:this.actionMethods.delete}).then(t=>{0==t.errno?(M.success("删除成功"),this.load("cur")):M.error("删除失败")})}}),this.updateUrl&&t.push({text:"编辑",icon:"st-icon st-icon-edit-square",click:t=>{let e=this;R({title:"编辑",width:600,height:"62%",html:'<x-form id="_st_update_form" size="medium" :field-list="fields" :default-values="params" label-width="100px" :label-width="100" :action-methods="actionMethods" @submit="edit"></x-form>',buttons:[{text:"确认修改",nativeType:"submit",form:"_st_update_form",type:"success"},{text:"取消",click(){this.close()}}],data:{fields:this.updateConfig,params:t,actionMethods:this.actionMethods},autoShow:!0,methods:{edit(s){let i=e.store.emit("beforeedit",s,t);if(!1===i)return;let l=e.updateUrl;i&&(i.url&&(l=i.url),i.data&&(s=i.data)),e.idIndex?(s[e.idIndex]=t[e.idIndex],e.ajax.request({url:l,data:s,method:e.actionMethods.update}).then(t=>{0==t.errno?(M.success("修改成功"),this.close(),e.load("cur"),e.store.emit("edit",t,s)):M.error(t.errmsg)})):alert("请配置参数 idIndex")}}})}}),t},layout(){if(!this.$el)return;let t=this.$el.querySelector(".st-table-body-area").clientWidth,e=[],s=0,i=0,l=this.columns;if(l.forEach((l,o)=>{if("pad"!=l.type)if(void 0!==l.width){if("string"==typeof l.width&&/^([\d.]+)%$/.test(l.width)){let e=Math.floor(t*parseFloat(RegExp.$1)/100);return e<100&&(e=100),void 0!==l.minWidth&&e<l.minWidth&&(e=l.minWidth),void 0!==l.maxWidth&&e>l.maxWidth&&(e=l.maxWidth),l._st_width=e,void(i+=e)}l._st_width=parseInt(l.width),i+=l._st_width}else s+=l.flex,e.push(o)}),e.length>0){let o=t-i;for(let t of e){let e=l[t].flex*o/s;e<100&&(e=100),void 0!==l[t].minWidth&&e<l[t].minWidth&&(e=l[t].minWidth),void 0!==l[t].maxWidth&&e>l[t].maxWidth&&(e=l[t].maxWidth),l[t]._st_width=Math.floor(e),i+=l[t]._st_width}}i<t?(this.freeColumns[this.freeColumns.length-1]._st_width=t-i,i=t):this.freeColumns[this.freeColumns.length-1]._st_width=0;let o=0,r=0,a=0;this.leftColumns.forEach(t=>o+=t._st_width),this.freeColumns.forEach(t=>r+=t._st_width),this.rightColumns.forEach(t=>a+=t._st_width),this.totalLeftWidth=o,this.totalFreeWidth=r,this.totalRightWidth=a},syncHeight(){this.syncTimer&&clearTimeout(this.syncHeight),this.syncTimer=setTimeout(()=>{this._syncHeight()},50)},_syncHeight(){this.syncTimer=null,this.recordsHeight=this.recordList.map(()=>"auto"),setTimeout(()=>{let t=this.$el.querySelectorAll(".st-table-body-left>table>tbody>tr"),e=this.$el.querySelectorAll(".st-table-body-free>table>tbody>tr"),s=this.$el.querySelectorAll(".st-table-body-right>table>tbody>tr");if(t.length>0||s.length>0){let i=[];for(let l=0,o=e.length;l<o;l++){let o=t[l]&&t[l].getBoundingClientRect().height||0,r=s[l]&&s[l].getBoundingClientRect().height||0,a=e[l]&&e[l].getBoundingClientRect().height||0,n=Math.max(o,a,r);i.push(n+"px")}this.recordsHeight=i,setTimeout(()=>{let t=this.$el.querySelector(".st-table-body-free");this.fakeVisible=t.scrollWidth>t.clientWidth,this.fakeVisible&&(this.$el.querySelector(".st-fake-scrollbar").style.width=this.$el.querySelector(".st-table-body-panel").clientWidth+"px")},0)}},0)},showMenu(t){if(!this.menu){let t=this;this.menu=new Vue({provide:{store:this.store},components:{XMenu:Tt},methods:{formatColumns(){t.formatColumns()}},template:'<x-menu ref="menu" @updatecolumn="formatColumns" />'});let e=document.createElement("div");document.body.appendChild(e),this.menu.$mount(e)}this.menu.$refs.menu.show(t)}}},Wt=(s(36),r(Ft,xt,[],!1,null,null,null));Wt.options.__file="src/table/index.vue";var Ht=Wt.exports,Bt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"st-toolbar st-pn"},["waterfall"==t.pageMode?s("div",{staticClass:"st-pn-waterfall"},[s("x-button",{attrs:{conf:{icon:"st-icon st-icon-left",size:"small",disabled:!t.store.hasPrePage,title:t.locale.previousPage}},on:{click:function(e){t.store.loadAction="loadPrePage"}}}),t._v(" "),s("x-button",{attrs:{conf:{icon:"st-icon st-icon-left st-pn-right",size:"small",disabled:!t.store.hasNextPage,title:t.locale.nextPage}},on:{click:function(e){t.store.loadAction="loadNextPage"}}})],1):s("div",{staticClass:"st-pn-normal"},[s("x-button",{attrs:{conf:{icon:"st-icon st-icon-left",size:"small",disabled:t.store.page<=1,title:t.locale.previousPage}},on:{click:function(e){return t.jumpTo(t.store.page-1)}}}),t._v(" "),t._l(t.pnoList,(function(e,i){return s("x-button",{key:i,attrs:{pno:t.store.page,conf:{cls:t.store.page==e.pno?"st-pn-active":"",size:"small",text:e.text||e.pno}},on:{click:function(s){return t.jumpTo(e.pno)}}})})),t._v(" "),s("x-button",{attrs:{conf:{icon:"st-icon st-icon-left st-pn-right",size:"small",disabled:t.store.page>=t.store.pageCount,title:t.locale.nextPage}},on:{click:function(e){return t.jumpTo(t.store.page+1)}}})],2),t._v(" "),t.pagination.pageSizeOptions?s("select",{directives:[{name:"model",rawName:"v-model",value:t.pageSize,expression:"pageSize"}],staticClass:"st-pn-size",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.pageSize=e.target.multiple?s:s[0]}}},t._l(t.pagination.pageSizeOptions,(function(e,i){return s("option",{key:i,domProps:{value:e,textContent:t._s(e+" "+t.locale.pageSizeUnit)}})})),0):t._e(),t._v(" "),s("div",{staticClass:"st-toolbar-separator"},[t._v("\n\t\t \n\t")]),t._v(" "),s("x-button",{attrs:{conf:{icon:"st-icon st-icon-sync",size:"small",title:t.locale.refresh}},on:{click:t.refresh}}),t._v(" "),s("div",{staticClass:"st-flex-padding"}),t._v(" "),s("div",{staticClass:"st-pn-msg",domProps:{textContent:t._s(t.msg)}})],1)};Bt._withStripped=!0;var Xt={inject:{store:"store",pageMode:"pageMode",pagination:{default:{}},params:"params",locale:"locale"},components:{XButton:v},data(){return{msg:"",pageSize:this.params.count,pnoList:[{pno:1}]}},watch:{"store.pageCount"(){this.buildPno()},"store.page"(){this.buildPno()}},methods:{jumpTo(t){t>0&&t<=this.store.pageCount&&(this.store.page=t)},buildPno(){let t=this.store.pageCount,e=[],s=this.store.page;if(t<=9)for(let s=1;s<=t;s++)e.push({pno:s});else if(s<=5){for(let t=1;t<=7;t++)e.push({pno:t});e.push({pno:Math.floor((7+t)/2),text:"..."}),e.push({pno:t})}else if(t-s<=4){let s=t-6;e.push({pno:1}),e.push({pno:Math.floor((1+s)/2),text:"..."});for(let i=s;i<=t;i++)e.push({pno:i})}else{let i=s-2,l=s+2;e.push({pno:1}),e.push({pno:Math.floor((1+i)/2),text:"..."});for(let t=i;t<=l;t++)e.push({pno:t});e.push({pno:Math.floor((l+t)/2),text:"..."}),e.push({pno:t})}this.pnoList=e},refresh(){this.$parent.$refs.table[0].refresh()}}},Ut=(s(37),r(Xt,Bt,[],!1,null,null,null));Ut.options.__file="src/Pagination.vue";var Yt=Ut.exports;let Kt=function(){},Jt={method:"GET",dataType:"json",accepts:{json:"application/json"},timeout:0,cache:!0};function Qt(t,e){return e?t+(t.includes("?")?"&":"?")+e:t}function Zt(t){let e=new window.URLSearchParams;return function t(e,s,i){Array.isArray(s)?s.forEach(s=>t(e,s,"".concat(i,"[]"))):$(s)?i?Object.keys(s).forEach(l=>t(e,s[l],"".concat(i,"[").concat(l,"]"))):Object.keys(s).forEach(i=>t(e,s[i],i)):e.append(i,s)}(e,t),e.toString()}class Gt{constructor(t){this.setting=Object.assign({},Jt,t)}request(t){return new Promise((e,s)=>{let i=t.data||null;delete t.data;let l=Object.assign({},this.setting,t||{}),o=l.url.indexOf("#");o>-1&&(l.url=l.url.slice(0,o)),l.method=l.method.toUpperCase(),["GET","HEAD"].includes(l.method)&&(l.url=Qt(l.url,Zt(i)),i=null),!1===l.cache&&(l.url=Qt(l.url,"_="+Date.now()));var r,a=l.dataType,n=l.accepts[a],d={},c=function(t,e){d[t.toLowerCase()]=[t,e]},h=/^([\w-]+:)\/\//.test(l.url)?RegExp.$1:window.location.protocol,u=new window.XMLHttpRequest,p=u.setRequestHeader;if(c("X-Requested-With","XMLHttpRequest"),c("Accept",n||"*/*"),(n=l.mimeType||n)&&(n.indexOf(",")>-1&&(n=n.split(",",2)[0]),u.overrideMimeType&&u.overrideMimeType(n)),l.contentType&&c("Content-Type",l.contentType),l.headers)for(let t in l.headers)c(t,l.headers[t]);u.onreadystatechange=function(){if(4==u.readyState){u.onreadystatechange=Kt,clearTimeout(r);var t,i=!1;if(u.status>=200&&u.status<300||304==u.status||0==u.status&&"file:"==h){t=u.responseText.trim();try{t=t&&JSON.parse(t)||{}}catch(t){i=t}if(i)return void s([u,"parsererror",i]);t&&void 0!==t.code&&(t.errno=t.code,t.errmsg=t.msg),e(t)}else s([u,u.status?"error":"abort",u.statusText||null])}},u.open(l.method,l.url);for(let t in d)p.apply(u,d[t]);l.timeout>0&&(r=setTimeout((function(){u.onreadystatechange=Kt,u.abort(),s([u,"timeout",null])}),l.timeout)),i&&(i instanceof window.FormData||"string"==A(i)||(i=Zt(i))),u.send(i)})}}var te=s(18);let ee=0;var se={props:{config:{type:Object,required:!0}},provide(){let t=Object.assign({title:"",url:"",rowNumberVisible:!1,selectMode:"none",pageMode:"normal",pageIndex:"id",listeners:{},ignoreEmptySearchParam:!0,parallelCount:6,dynamicParallelCount:!1,downloadTimeout:3e4,downloadAllFromJustOnePage:!1,labelVisible:!0,layoutMode:"fixed",searchResetable:!1,records:!1,idIndex:"",addUrl:"",deleteUrl:"",updateUrl:"",tip:"",downloadable:!1,searchFilter:!1},window.STable&&window.STable.default||{},this.config);t.locale?"string"==typeof t.locale&&(window.STable&&Window.STable.lang[t.locale]?(t.locale=Window.STable.lang[t.locale],t.locale=t.locale.default||t.locale):t.locale=te):t.locale=te,"expand"!=t.layoutMode&&t.layoutMode;let e=t.actionMethods||t.requestMethod||"GET";"string"==typeof e&&(e={read:e});t.actionMethods=Object.assign({create:"POST",read:"GET",update:"POST",delete:"POST"},e),t.sublistAt?Array.isArray(t.sublistAt)||(t.sublistAt=[t.sublistAt]):t.sublistAt=[];let s=t.additionalColumnConfig||t.acc||!1,i=t.columns.map((t,e)=>{"string"==typeof t&&(t={text:t,dataIndex:t}),s&&(Array.isArray(s)?Object.assign(t,s[e]):t.dataIndex&&s[t.dataIndex]&&Object.assign(t,s[t.dataIndex])),t.header&&(t.text=t.header),t.text||(t.text=t.dataIndex||"-"),t.options&&Object.keys(t.options).length<=0&&(t.options=!1),t.buttons&&(t.type||(t.type="button")),t.dataIndex||(t.dataIndex="_st_column_"+e),t.render&&(t.type="render"),t.options&&!t.type&&(t.type="option"),t.type||(t.type="text"),void 0===t.width&&void 0===t.flex&&(t.flex=1);let i=typeof t.width;return"undefined"!=i?"string"==i&&(/^[\d.]+%$/.test(t.width)||(t.width=parseInt(t.width,10))):void 0!==t.flex?t.flex=parseFloat(t.flex):t.flex=1,(t=Object.assign({visible:!0,locked:!1,cellWrap:!0,resizable:!0,_st_ori_idx:e,_hl:!1},t)).locked?"right"!=t.locked&&(t.locked="left"):t.locked=!1,t});if(t.params=Object.assign({count:20},t.params,t.postParam,t.postData),t.urlSearchParams={},0==ee&&window.location.search.includes("stable=on")){let e=new window.URLSearchParams(window.location.search);if("on"==e.get("stable")){e.delete("stable");let s={};for(let t of e)if(/(.+)\[\]$/.test(t[0])){let e=RegExp.$1;s[e]?s[e].push(t[1]):s[e]=[t[1]]}else s[t[0]]=t[1];t.urlSearchParams=s}}t.editUrl&&(t.updateUrl=t.editUrl),t.updateUrl?t.updateConfig=t.updateConfig||t.editConfig||t.editConf||t.metaEditConf:t.updateConfig={},t.addUrl?t.addConfig=t.addConfig||t.addConf||t.updateConfig:t.addConfig={};let l=t.selectMode.trim().toLowerCase();["radio","single"].includes(l)?t.selectMode="single":["checkbox","mul","multi","multiple"].includes(l)?t.selectMode="multiple":t.selectMode="none",t.batDeleteUrl&&(t.selectMode="multiple"),void 0!==t.page&&(t.params.page=t.page),t.sort_key&&(t.sortKey=t.sort_key),t.sort_direction&&(t.sortDirection=t.sort_direction),t.sortDirection||(t.sortDirection="asc"),t.ajax=new Gt(t.ajaxSetting);let o=window.location;let r;t._storage_key=(o.host+o.pathname+JSON.stringify(i)).split("").reduce((function(t,e){return(t=(t<<5)-t+e.charCodeAt(0))&t}),0).toString(16);try{r=window.localStorage.getItem(t._storage_key),r&&(r=JSON.parse(r))}catch(t){r="",alert("本地存储的列信息有问题")}if(r){let t=[];for(let e of r)for(let s of i)if(s._st_ori_idx==e._st_ori_idx){Object.assign(s,{locked:e.locked,visible:e.visible,_st_idx:e._st_idx}),t.push(s);break}i=t}let a=this;return t.store=new Vue({data:{storageKey:t._storage_key,columns:i,page:t.params.page||1,pageCount:1,hasNextPage:!0,hasPrePage:!1,loadAction:"",radioVal:"",checkboxVal:[],chkAll:!1,sortKey:t.sortKey||"",sortDirection:t.sortDirection,hlRowNum:-1,focusRowNum:-1},methods:{saveColumnsState(){let t=this.columns.map(t=>({text:t.text,visible:t.visible,locked:t.locked,_st_idx:t._st_idx,_st_ori_idx:t._st_ori_idx}));try{window.localStorage.setItem(this.storageKey,JSON.stringify(t))}catch(t){k.error(t)}},resetColumnsState(){try{window.localStorage.removeItem(this.storageKey),location.reload()}catch(t){k.error(t)}},emit(e,...s){if(t.listeners&&t.listeners[e])return t.listeners[e].apply(a,s)}}}),t.store.searchParams={},delete t.columns,delete t.params.page,t},data(){let t={title:n,tip:u,toolbar:ft,search:vt,table:Ht,pagination:Yt},e=["title","tip","toolbar","search","table","pagination"];return this.config.componentOrder&&(e=this.config.componentOrder),{comOrder:e.map(e=>({name:e,com:t[e]}))}},mounted(){this.config.listeners&&this.config.listeners.ready&&this.config.listeners.ready.call(this),ee++,setTimeout(()=>{this.config.searchFilter?this.$refs.search[0].$el.querySelector("[type=submit]").click():this.$refs.table[0].load()},0)},methods:{refresh(t){return this.$refs.table[0].refresh(t)},getSearchParam(){return Object.assign({},this.$refs.search[0].$refs.form.getFormData())},getSelectRows(){return this.getSelected()},getSelectedRows(){return this.getSelected()},getSelected(){return this.$refs.table[0].getSelectRows()},layout(){this.$refs.table[0].layout(),this.$refs.table[0].syncHeight()},setRecords(t){this.$refs.table[0].setRecords(t)},getToolbarBtn(t){let e=this.$refs.toolbar;if(!(e&&e[0]&&e[0].$refs&&e[0].$refs.btn))return;let s=e[0].$refs.btn;return void 0===t?s:"string"==A(t)?(s=s.filter(e=>e.conf.id==t),s[0]):s[t]}}},ie=(s(38),r(se,i,[],!1,null,null,null));ie.options.__file="src/STable.vue";var le=ie.exports;Vue.component("x-stable",le),Vue.component("x-form",ht),k.log("%c👩‍💻STable docs: https://inagora.github.io/STable/","font-size:14px");var oe="2.0.0";function re(t,e){let s=t.el||t.container||"#stableContainer";return"string"==typeof s?s=document.querySelector(s):s.length&&(s=s[0]),s instanceof HTMLElement?(s.innerHTML='<x-stable ref="stable" :config="config"></x-stable>',e||(e=window.Vue),!e||!e.version||e.version<"2"?(k.error("Please ensure Vue is installed."),null):new e({data:{config:t}}).$mount(s).$refs.stable):(k.error("The container is not a dom, please check!"),null)}}]);